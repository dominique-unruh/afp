%
\begin{isabellebody}%
\setisabellecontext{Modified{\isacharunderscore}{\kern0pt}Policy{\isacharunderscore}{\kern0pt}Iteration}%
%
\isadelimtheory
\isanewline
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Modified{\isacharunderscore}{\kern0pt}Policy{\isacharunderscore}{\kern0pt}Iteration\isanewline
\ \ \isakeyword{imports}\ \isanewline
\ \ \ \ Policy{\isacharunderscore}{\kern0pt}Iteration\isanewline
\ \ \ \ Value{\isacharunderscore}{\kern0pt}Iteration\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Modified Policy Iteration%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{locale}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}MPI\ {\isacharequal}{\kern0pt}\ MDP{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}type\ A\ K\ r\ l\ {\isacharplus}{\kern0pt}\ MDP{\isacharunderscore}{\kern0pt}act\ A\ K\ r\ l\ arb{\isacharunderscore}{\kern0pt}act\isanewline
\ \ \isakeyword{for}\ A\ \isakeyword{and}\ K\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ finite\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ finite\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}s\ pmf{\isachardoublequoteclose}\ \isakeyword{and}\ r\ l\ arb{\isacharunderscore}{\kern0pt}act\isanewline
\isakeyword{begin}%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The Advantage Function \isa{B}%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}B\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\ d\ s\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
The function \isa{B} denotes the advantage of choosing the optimal action vs.
  the current value estimate%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ B{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ v\ s\ {\isacharequal}{\kern0pt}\ {\isasymL}\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ L\ d\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ B{\isacharunderscore}{\kern0pt}def\ L{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ add{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ antisym{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSqunion}d{\isasymin}D\isactrlsub R{\isachardot}{\kern0pt}\ L\ d\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymL}\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymL}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isacharunderscore}{\kern0pt}dec\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}upper\ cSUP{\isacharunderscore}{\kern0pt}least{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}bdd{\isacharunderscore}{\kern0pt}above\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}d{\isachardot}{\kern0pt}\ L\ d\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ D\isactrlsub R{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}const\ bounded{\isacharunderscore}{\kern0pt}minus{\isacharunderscore}{\kern0pt}comp\ bounded{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}bdd{\isacharunderscore}{\kern0pt}above{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymL}\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ L\ d\ v\ s\ {\isacharminus}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymL}{\isacharunderscore}{\kern0pt}def\ diff{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ cSUP{\isacharunderscore}{\kern0pt}least{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}upper{\isadigit{2}}\ simp{\isacharcolon}{\kern0pt}\ diff{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
\isa{B} is a bounded function.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ B\isactrlsub b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}B{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ B{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bfun{\isacharunderscore}{\kern0pt}normI\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ abs{\isacharunderscore}{\kern0pt}triangle{\isacharunderscore}{\kern0pt}ineq{\isadigit{4}}{\isacharbrackright}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}mono\ abs{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}bfun{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}B\isactrlsub b\ v\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ v\ {\isacharminus}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ B\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ B{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}L\isactrlsub a{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymL}\isactrlsub b\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}a\ {\isasymin}\ A\ s{\isachardot}{\kern0pt}\ L\isactrlsub a\ a\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L\isactrlsub a{\isacharunderscore}{\kern0pt}det\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}det\ SUP{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Optimization of the Value Function over Multiple Steps%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}U\ m\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}%
\begin{isamarkuptext}%
\isa{U} expresses the value estimate obtained by optimizing the first \isa{m} steps and 
  afterwards using the current estimate.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ U{\isacharunderscore}{\kern0pt}zero\ {\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\ {\isadigit{0}}\ v\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ U{\isacharunderscore}{\kern0pt}def\ {\isasymL}{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\ {\isadigit{1}}\ v\ s\ {\isacharequal}{\kern0pt}\ {\isasymL}\ v\ s{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ U{\isacharunderscore}{\kern0pt}def\ {\isasymL}{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub X\ L{\isacharunderscore}{\kern0pt}def\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ U\isactrlsub b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{is}\ U\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ n\ v\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}norm\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ l\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ r\isactrlsub M{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ d\ m\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ abs{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}le\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ norm{\isacharunderscore}{\kern0pt}bound{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}norm\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymle}\ l\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ norm\ v{\isachardoublequoteclose}\ \isakeyword{for}\ d\ m\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}const{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ simp\ del{\isacharcolon}{\kern0pt}\ {\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}sconst\ \isanewline
\ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ boundedI\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ abs{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}bfun{\isacharbrackright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}norm\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ l\ {\isacharcircum}{\kern0pt}\ i\ {\isacharasterisk}{\kern0pt}\ r\isactrlsub M{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ \ l\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ norm\ v{\isachardoublequoteclose}\ \isakeyword{for}\ d\ m\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ norm{\isacharunderscore}{\kern0pt}triangle{\isacharunderscore}{\kern0pt}mono\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}U\ n\ v\ {\isasymin}\ bfun{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isacharunderscore}{\kern0pt}dec\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ abs{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}bfun\ {\isacharasterisk}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ U{\isacharunderscore}{\kern0pt}def\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ bfun{\isacharunderscore}{\kern0pt}normI\ cSup{\isacharunderscore}{\kern0pt}abs{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}contraction{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ u{\isacharparenright}{\kern0pt}\ {\isasymle}\ l\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ u\ s{\isacharparenright}{\kern0pt}\ {\isasymle}\ l\ {\isacharcircum}{\kern0pt}\ m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\ \isakeyword{if}\ le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\isactrlsub b\ m\ u\ s\ {\isasymle}\ U\isactrlsub b\ m\ v\ s{\isachardoublequoteclose}\ \isakeyword{for}\ s\ v\ u\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}U\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}m\ v\ d{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ s\ {\isacharminus}{\kern0pt}\ U\isactrlsub b\ m\ u\ s\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}U\ m\ v\ d\ {\isacharminus}{\kern0pt}\ {\isacharquery}{\kern0pt}U\ m\ u\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ bounded{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ le\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ U\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ U{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ le{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}diff{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}comp{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}def\ scale{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ blinfun{\isachardot}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\isactrlsub R{\isacharunderscore}{\kern0pt}ne\ bounded{\isacharunderscore}{\kern0pt}P\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}mul{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ norm\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ norm\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ D\isactrlsub R{\isacharunderscore}{\kern0pt}ne\ ex{\isacharunderscore}{\kern0pt}dec\ bounded{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}comp\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ norm\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isacharunderscore}{\kern0pt}dec\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ norm{\isacharunderscore}{\kern0pt}blinfun{\isacharbrackright}{\kern0pt}\ abs{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}bfun\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ cSUP{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ norm\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}v\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ norm{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}apply\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}const{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}least\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ l\ {\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}norm{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ s\ {\isacharminus}{\kern0pt}\ U\isactrlsub b\ m\ u\ s\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}def\ le{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ s\ {\isasymle}\ U\isactrlsub b\ m\ u\ s\ {\isasymLongrightarrow}\ dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ u\ s{\isacharparenright}{\kern0pt}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\ \isakeyword{for}\ u\ v\ s\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ aux\ dist{\isacharunderscore}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ u\ s{\isacharparenright}{\kern0pt}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\ \isakeyword{for}\ u\ v\ s\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ linear\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ u{\isacharparenright}{\kern0pt}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}bound{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}v{\isachardot}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isacharparenleft}{\kern0pt}THE\ v{\isachardot}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}contraction\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}contraction{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}contraction{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}Suc\ m{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ le{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}disc{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ power{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}one\ intro{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}l{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}{\isacharbang}{\kern0pt}v{\isachardot}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isacharparenleft}{\kern0pt}THE\ v{\isachardot}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ banach{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ {\isacharasterisk}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}convergent{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}convergent\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ convergentI{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}mono{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v\ {\isasymle}\ u{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ {\isasymle}\ U\isactrlsub b\ m\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ \ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ s\ {\isasymle}\ U\isactrlsub b\ m\ u\ s{\isachardoublequoteclose}\ \isakeyword{for}\ s\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ U\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ U{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ cSUP{\isacharunderscore}{\kern0pt}mono{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{2}}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}bdd{\isacharunderscore}{\kern0pt}above\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ bounded{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}comp\ bounded{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bfunD{\isacharbrackleft}{\kern0pt}OF\ {\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}mono{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymP}\isactrlsub X{\isacharunderscore}{\kern0pt}const{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ blinfun{\isachardot}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}left\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ exI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}d\ {\isasymin}\ D\isactrlsub R{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ d{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ m\ v\ s\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}iter\ U\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ U{\isacharunderscore}{\kern0pt}def\ {\isasymL}{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}iter{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ ex{\isacharunderscore}{\kern0pt}dec\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}least{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}iter{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub R{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}L\ d{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v\ {\isasymle}\ U\isactrlsub b\ m\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}upper\ bounded{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}bdd{\isacharunderscore}{\kern0pt}above\isanewline
\ \ \ \ \ \ simp{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}iter\ U\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ U{\isacharunderscore}{\kern0pt}def\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ bounded{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}comp\ bounded{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ lim{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}lim\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}U{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymle}\ U\isactrlsub b\ m\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\ \isakeyword{for}\ m\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ d\ \isakeyword{where}\ d{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ ex{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}det\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}metis\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix{\isacharunderscore}{\kern0pt}iff\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ d{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ funpow{\isacharunderscore}{\kern0pt}swap{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}d\ {\isasymin}\ D\isactrlsub D{\isacartoucheclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}iter{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymle}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\ \isakeyword{for}\ m\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymL}{\isacharunderscore}{\kern0pt}inc{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}opt\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharbrackright}{\kern0pt}\ simp{\isacharcolon}{\kern0pt}\ funpow{\isacharunderscore}{\kern0pt}swap{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ le{\isacharunderscore}{\kern0pt}U\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ antisym{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}lim\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}lim\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ limI{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ theI{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ metis\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}tendsto{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ lim{\isacharunderscore}{\kern0pt}U\isactrlsub b\ U\isactrlsub b{\isacharunderscore}{\kern0pt}convergent\ convergent{\isacharunderscore}{\kern0pt}LIMSEQ{\isacharunderscore}{\kern0pt}iff\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ metis%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ U\isactrlsub b{\isacharunderscore}{\kern0pt}fix{\isacharunderscore}{\kern0pt}unique{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ v\ {\isasymlongleftrightarrow}\ v\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ theI{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ LIMSEQ{\isacharunderscore}{\kern0pt}unique{\isacharbrackleft}{\kern0pt}OF\ U\isactrlsub b{\isacharunderscore}{\kern0pt}tendsto\ U\isactrlsub b{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}of\ m{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharequal}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}U\isactrlsub b\ m\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ U\isactrlsub b{\isachardot}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq\ U\isactrlsub b{\isacharunderscore}{\kern0pt}fix{\isacharunderscore}{\kern0pt}unique\ U{\isacharunderscore}{\kern0pt}zero\ apply{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}inverse\ not{\isadigit{0}}{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}Suc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l{\isacharcircum}{\kern0pt}m\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ U\isactrlsub b{\isacharunderscore}{\kern0pt}contraction{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Expressing a Single Step of Modified Policy Iteration%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The function \isa{W} equals the value computed by the Modified Policy Iteration Algorithm
  in a single iteration.
  The right hand addend in the definition describes the advantage of using the optimal action for 
  the first m steps.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}W\ d\ m\ v\ {\isacharequal}{\kern0pt}\ v\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}iter{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ v\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}W\ d\ m\ v\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ d{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ d\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}W\ d\ m\ v\ {\isacharequal}{\kern0pt}\ \ v\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ d\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ W{\isacharunderscore}{\kern0pt}def\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ algebra{\isacharunderscore}{\kern0pt}simps\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ v\ {\isacharplus}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}eq\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ blinfun{\isachardot}{\kern0pt}sum{\isacharunderscore}{\kern0pt}left\ scaleR{\isacharunderscore}{\kern0pt}right{\isachardot}{\kern0pt}sum{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ v\ {\isacharplus}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ del{\isacharcolon}{\kern0pt}\ blinfunpow{\isachardot}{\kern0pt}simps\ simp{\isacharcolon}{\kern0pt}\ blinfunpow{\isacharunderscore}{\kern0pt}assoc{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}Suc\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ \ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isacharless}{\kern0pt}m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isachardot}{\kern0pt}lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}shift{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ \ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}sum{\isacharunderscore}{\kern0pt}left{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ d\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}iter\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v\ {\isasymle}\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ v\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}W\ d\ m\ v\ {\isasymle}\ U\isactrlsub b\ m\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}U\isactrlsub b\ m\ u\ {\isacharminus}{\kern0pt}\ W\ d\ m\ v\ {\isasymge}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ u\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ d{\isacharparenright}{\kern0pt}\ m\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}m{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}D{\isacharunderscore}{\kern0pt}MR\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ bounded{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ diff{\isacharunderscore}{\kern0pt}mono\ bounded{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}bdd{\isacharunderscore}{\kern0pt}above\ cSUP{\isacharunderscore}{\kern0pt}upper\ bounded{\isacharunderscore}{\kern0pt}plus{\isacharunderscore}{\kern0pt}comp\ simp{\isacharcolon}{\kern0pt}\ U\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ U{\isacharunderscore}{\kern0pt}def\ L{\isacharunderscore}{\kern0pt}iter\ W{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}iter{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}U\isactrlsub b\ m\ u\ {\isacharminus}{\kern0pt}\ W\ d\ m\ v\ {\isasymge}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u\ {\isacharminus}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}W\ d\ m\ v\ {\isasymle}\ U\isactrlsub b\ m\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ {\isasymP}\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}n{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}pos{\isacharbrackleft}{\kern0pt}unfolded\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ W{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v\ {\isasymle}\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ B\isactrlsub b\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ u\ d{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymL}\isactrlsub b\ v\ {\isasymle}\ W\ d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymL}\isactrlsub b\ v\ {\isasymle}\ u\ {\isacharplus}{\kern0pt}\ B\isactrlsub b\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}mono\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ W\ d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}mono\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ assms\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ W{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}iter\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ B\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ v\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}B\isactrlsub b\ v\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}u\ {\isacharminus}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isasymle}\ B\isactrlsub b\ u{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ d\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ u\ {\isasymle}\ B\isactrlsub b\ u{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}def\ L{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ assms\ \ \ \ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ {\isasymL}{\isacharunderscore}{\kern0pt}def\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}B\isactrlsub b\ v\ {\isacharequal}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ d\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ d{\isacharbrackright}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}def\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}W{\isacharunderscore}{\kern0pt}ge{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}u\ {\isasymle}\ {\isasymL}\isactrlsub b\ u{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ u\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}W\ d\ m\ u\ {\isasymle}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}W\ d\ m\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ m{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ {\isasymP}\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}n{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}pos\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ diff{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}ge{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}{\isadigit{0}}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ u{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isachardot}{\kern0pt}lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}shift{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}left{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ B\isactrlsub b\ u\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ o\isactrlsub L\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isacharless}{\kern0pt}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ sum{\isacharunderscore}{\kern0pt}subtractf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ B\isactrlsub b\ u\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d\ {\isacharminus}{\kern0pt}\ id{\isacharunderscore}{\kern0pt}blinfun{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}W\ d\ m\ u\ {\isacharminus}{\kern0pt}\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ W{\isacharunderscore}{\kern0pt}def\ sum{\isachardot}{\kern0pt}lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharbrackleft}{\kern0pt}unfolded\ lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}atMost{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ B\isactrlsub b\ {\isacharparenleft}{\kern0pt}W\ d\ m\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ B\isactrlsub b{\isacharunderscore}{\kern0pt}le\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ B\isactrlsub b\ {\isacharparenleft}{\kern0pt}W\ d\ m\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isacommand{using}\isamarkupfalse%
\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Computing the Bellman Operator over Multiple Steps%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}pow\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}L{\isacharunderscore}{\kern0pt}pow\ v\ d\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ Suc\ m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ sum{\isacharunderscore}{\kern0pt}telescope{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}i{\isasymle}k{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ f\ i\ {\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}Suc\ k{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}f\ {\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}c\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ ab{\isacharunderscore}{\kern0pt}group{\isacharunderscore}{\kern0pt}add{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ sum{\isacharunderscore}{\kern0pt}telescope{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isacharminus}{\kern0pt}f{\isachardoublequoteclose}\ k{\isacharbrackright}{\kern0pt}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ v\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}L{\isacharunderscore}{\kern0pt}pow\ v\ d\ m\ {\isacharequal}{\kern0pt}\ v\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}d\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ v{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}def\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}sum{\isacharunderscore}{\kern0pt}left\ blinfunpow{\isacharunderscore}{\kern0pt}assoc\ simp\ del{\isacharcolon}{\kern0pt}\ blinfunpow{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ i{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}subtractf{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharminus}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}telescope{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}bilinear{\isacharunderscore}{\kern0pt}simps{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v\ {\isacharminus}{\kern0pt}\ v{\isachardoublequoteclose}\ \isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}L{\isacharunderscore}{\kern0pt}pow\ v\ d\ m\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharparenright}{\kern0pt}{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ only{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}def\ L{\isacharunderscore}{\kern0pt}iter\ lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}atMost{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}eq\ lessThan{\isacharunderscore}{\kern0pt}Suc{\isacharunderscore}{\kern0pt}atMost{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}W{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ W\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ m{\isacharparenright}{\kern0pt}\ v{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}improving\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ W{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}iter\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}inv{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ {\isachardoublequoteopen}v\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ m\ {\isasymle}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}W\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}W{\isacharunderscore}{\kern0pt}ge\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}improving\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{The Modified Policy Iteration Algorithm%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{fixes}\ d{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{fixes}\ v{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{fixes}\ m\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ nat{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{assumes}\ d{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}d{\isadigit{0}}\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\begin{isamarkuptext}%
We first define a function that executes the algorithm for n steps.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ mpi\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}nat\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymtimes}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}mpi\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d{\isadigit{0}}\ v{\isadigit{0}}{\isacharcomma}{\kern0pt}\ v{\isadigit{0}}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}mpi\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ {\isacharparenleft}{\kern0pt}let\ {\isacharparenleft}{\kern0pt}d{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ mpi\ n{\isacharsemicolon}{\kern0pt}\ v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}pow\ v\ d\ {\isacharparenleft}{\kern0pt}m\ n\ v{\isacharparenright}{\kern0pt}\ in\isanewline
\ \ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ v{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isacharequal}{\kern0pt}\ snd\ {\isacharparenleft}{\kern0pt}mpi\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}pol\ n\ {\isacharequal}{\kern0pt}\ fst\ {\isacharparenleft}{\kern0pt}mpi\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}zero{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}pol\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}improvement\ d{\isadigit{0}}\ v{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}Suc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}pol\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}improvement\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}pol\ n\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isadigit{0}}\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def\ split{\isacharcolon}{\kern0pt}\ prod{\isachardot}{\kern0pt}splits{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ d{\isadigit{0}}\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}improving\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}Suc\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}zero{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ v{\isadigit{0}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}Suc{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}pow\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ n\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ case{\isacharunderscore}{\kern0pt}prod{\isacharunderscore}{\kern0pt}beta{\isacharprime}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ \isanewline
\ \ mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i\ {\isasymle}\ m\ n\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}B\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}OF\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol{\isacharbrackright}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}Suc\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
Value Iteration is a special case of MPI where \isa{{\isasymforall}n\ v{\isachardot}{\kern0pt}\ m\ n\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}includes{\isacharunderscore}{\kern0pt}value{\isacharunderscore}{\kern0pt}it{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isasymforall}n\ v{\isachardot}{\kern0pt}\ m\ n\ v\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Convergence Proof%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We define the sequence \isa{w} as an upper bound for the values of MPI.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ w\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}w\ {\isadigit{0}}\ {\isacharequal}{\kern0pt}\ v{\isadigit{0}}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}w\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ U\isactrlsub b\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}m\ n\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}w\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}w\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymle}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}w\ n{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ intro{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ dist{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharbrackright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ power{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}one\isanewline
\ \ \ \ \ \ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}one{\isacharunderscore}{\kern0pt}le\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}order{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}n{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}w\ n{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isasymle}\ l{\isacharcircum}{\kern0pt}n\ {\isacharasterisk}{\kern0pt}\ dist\ v{\isadigit{0}}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ intro{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ dist{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharbrackright}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}{\isacharplus}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ w{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}w\ {\isasymlonglonglongrightarrow}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ l{\isacharcircum}{\kern0pt}n\ {\isacharasterisk}{\kern0pt}\ dist\ v{\isadigit{0}}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ LIMSEQ{\isacharunderscore}{\kern0pt}realpow{\isacharunderscore}{\kern0pt}zero\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}v{\isadigit{0}}\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ metric{\isacharunderscore}{\kern0pt}LIMSEQ{\isacharunderscore}{\kern0pt}I\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ dist{\isacharunderscore}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}n{\isacharbrackright}{\kern0pt}\ simp{\isacharcolon}{\kern0pt}\ LIMSEQ{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
MPI converges monotonically to the optimal value from below. 
  The iterates are sandwiched between \isa{{\isasymL}\isactrlsub b} from below and \isa{U\isactrlsub b} from above.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{theorem}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}conv{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v{\isadigit{0}}\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isasymlonglonglongrightarrow}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isasymAnd}n{\isachardot}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ y\ \isakeyword{where}\ {\isachardoublequoteopen}y\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b{\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}n{\isacharparenright}{\kern0pt}\ v{\isadigit{0}}{\isachardoublequoteclose}\ \isakeyword{for}\ n\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymle}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymand}\ y\ n\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymand}\ mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymle}\ w\ n{\isachardoublequoteclose}\ \isakeyword{for}\ n\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ y{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}eq\ blinfun{\isachardot}{\kern0pt}sum{\isacharunderscore}{\kern0pt}left\ {\isasymP}\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}n{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}pos\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ sum{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ val{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}W{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ W\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}m\ n\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}Suc\ W{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}iter\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}W{\isacharunderscore}{\kern0pt}ge\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}eq\ {\isasymP}\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}n{\isacharunderscore}{\kern0pt}disc{\isacharunderscore}{\kern0pt}pos\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ blinfun{\isachardot}{\kern0pt}sum{\isacharunderscore}{\kern0pt}left\ sum{\isacharunderscore}{\kern0pt}nonneg{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ w\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ val{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}W\ intro{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ W{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}U\isactrlsub b{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ W{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ y{\isacharunderscore}{\kern0pt}def\ B\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ val{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}W{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ n\ {\isasymle}\ mpi{\isacharunderscore}{\kern0pt}val\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ n\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}y\ {\isasymlonglonglongrightarrow}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}lim\ y{\isacharunderscore}{\kern0pt}def\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ {\isasymlonglonglongrightarrow}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ aux\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ tendsto{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}sandwich{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ w{\isacharunderscore}{\kern0pt}conv{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{$\epsilon$-Optimality%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
This gives an upper bound on the error of MPI.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}eps{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ eps\ {\isacharslash}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}p\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}d\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}v\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}val\ n{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ dist\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}triangle\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L\ {\isacharquery}{\kern0pt}d\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ contraction{\isacharunderscore}{\kern0pt}L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ contraction{\isacharunderscore}{\kern0pt}L\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isasymle}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}v{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}{\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isasymle}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ left{\isacharunderscore}{\kern0pt}diff{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ True\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ le{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}disc\ False{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ assms\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}commute\ pos{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq\ Groups{\isachardot}{\kern0pt}mult{\isacharunderscore}{\kern0pt}ac{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}l{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isacharquery}{\kern0pt}v{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute\ pos{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}l{\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ mult{\isacharunderscore}{\kern0pt}left{\isacharunderscore}{\kern0pt}mono\ simp{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}nonneg{\isacharunderscore}{\kern0pt}pos{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ eps\ {\isacharslash}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ False\ disc{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}one\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}order{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}p{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharquery}{\kern0pt}v{\isacharparenright}{\kern0pt}\ {\isasymle}\ eps\ {\isacharslash}{\kern0pt}\ {\isadigit{2}}{\isachardoublequoteclose}\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\ \ \ \ \isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}pol\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\ {\isasymle}\ eps{\isacharslash}{\kern0pt}{\isadigit{2}}\ {\isacharplus}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}eps{\isacharunderscore}{\kern0pt}opt{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharbrackright}{\kern0pt}\ dist{\isacharunderscore}{\kern0pt}commute\ dist{\isacharunderscore}{\kern0pt}triangle{\isacharunderscore}{\kern0pt}le\ add{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}eps\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v{\isadigit{0}}\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{note}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}opt\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}conv{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ tendsto{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}iff\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymlonglonglongrightarrow}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ dist{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}dist{\isacharunderscore}{\kern0pt}opt\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ metric{\isacharunderscore}{\kern0pt}LIMSEQ{\isacharunderscore}{\kern0pt}I\ intro{\isacharcolon}{\kern0pt}\ tendsto{\isacharunderscore}{\kern0pt}sandwich{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymforall}e\ {\isachargreater}{\kern0pt}{\isadigit{0}}{\isachardot}{\kern0pt}\ {\isasymexists}n{\isachardot}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ e{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ dest{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ metric{\isacharunderscore}{\kern0pt}LIMSEQ{\isacharunderscore}{\kern0pt}D{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}l\ {\isasymnoteq}\ {\isadigit{0}}\ {\isasymLongrightarrow}\ {\isasymexists}n{\isachardot}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ assms\ order{\isachardot}{\kern0pt}not{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}strict{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ le{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}trans{\isacharbrackleft}{\kern0pt}OF\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}disc{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}l\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute\ pos{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Unbounded MPI%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{context}\isamarkupfalse%
\isanewline
\ \ \isakeyword{fixes}\ eps\ {\isasymdelta}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ real\ \isakeyword{and}\ M\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{function}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}domintros{\isacharparenright}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}algo\ \isakeyword{where}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ if\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ \ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\isanewline
\ \ then\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ else\ mpi{\isacharunderscore}{\kern0pt}algo\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
We define a tailrecursive version of \isa{mpi} which more closely resembles \isa{mpi{\isacharunderscore}{\kern0pt}algo}.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{fun}\isamarkupfalse%
\ mpi{\isacharprime}{\kern0pt}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}mpi{\isacharprime}{\kern0pt}\ d\ v\ {\isadigit{0}}\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharbar}{\kern0pt}\isanewline
\ \ {\isachardoublequoteopen}mpi{\isacharprime}{\kern0pt}\ d\ v\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ let\ d{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharsemicolon}{\kern0pt}\ v{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}pow\ v\ d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}\ in\ mpi{\isacharprime}{\kern0pt}\ d{\isacharprime}{\kern0pt}\ v{\isacharprime}{\kern0pt}\ n\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}Suc{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ mpi\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ n{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ rule{\isacharcolon}{\kern0pt}\ nat{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi\ d\ v\ m\ n\ {\isacharequal}{\kern0pt}\ mpi{\isacharprime}{\kern0pt}\ d\ v\ n\ m{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ assms\isanewline
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ d\ v\ m\ rule{\isacharcolon}{\kern0pt}\ nat{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ nat{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}Suc{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\ Suc{\isachardot}{\kern0pt}IH{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ termination{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}algo{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ {\isachardoublequoteopen}v\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}d{\isacharcomma}{\kern0pt}\ v{\isacharcomma}{\kern0pt}\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}P\ d\ v\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ least{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymexists}n{\isachardot}{\kern0pt}\ P\ n\ {\isasymLongrightarrow}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ P\ n{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{0}}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ nat{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ P\ {\isadigit{0}}{\isachardoublequoteclose}\ \ \isakeyword{for}\ P\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ LeastI{\isacharunderscore}{\kern0pt}ex{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}def\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ v\ d\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ least{\isadigit{0}}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isadigit{0}}\ mpi{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}domintros\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}zero\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ opaque{\isacharunderscore}{\kern0pt}lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n\ v\ d\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}d\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Suc\ n\ {\isacharequal}{\kern0pt}\ Suc\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex{\isacharbrackleft}{\kern0pt}OF\ Suc{\isachardot}{\kern0pt}prems{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ {\isacartoucheopen}v\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isacartoucheclose}\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ eps{\isacartoucheclose}{\isacharcomma}{\kern0pt}\ of\ m{\isacharbrackright}{\kern0pt}\ Suc{\isachardot}{\kern0pt}prems\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ Nat{\isachardot}{\kern0pt}Least{\isacharunderscore}{\kern0pt}Suc{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ LeastI{\isacharunderscore}{\kern0pt}ex{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems\ mpi{\isacharunderscore}{\kern0pt}Suc{\isacharprime}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnot}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}zero\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}dom\ {\isacharparenleft}{\kern0pt}{\isacharquery}{\kern0pt}d{\isacharcomma}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharquery}{\kern0pt}d\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ {\isasymlambda}a{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}IH{\isacharbrackleft}{\kern0pt}OF\ n{\isacharunderscore}{\kern0pt}eq\ {\isacartoucheopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ eps{\isacartoucheclose}{\isacharbrackright}{\kern0pt}\ Suc{\isachardot}{\kern0pt}prems\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}inv\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}domintros\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}rec\ d\ v\ m\ {\isasymequiv}\ \isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}if\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ then\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ else\ mpi{\isacharunderscore}{\kern0pt}algo\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ {\isachardoublequoteopen}v\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v\ m\ {\isacharequal}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}rec\ d\ v\ m{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isachardot}{\kern0pt}psimps\ termination{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}algo\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mpi{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ {\isachardoublequoteopen}v\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v\ m\ {\isacharequal}{\kern0pt}\ mpi\ d\ v\ m\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{define}\isamarkupfalse%
\ n\ \isakeyword{where}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isacharparenleft}{\kern0pt}\isakeyword{is}\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}P\ d\ v\ m\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{from}\isamarkupfalse%
\ n{\isacharunderscore}{\kern0pt}def\ assms\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ n\ arbitrary{\isacharcolon}{\kern0pt}\ d\ v\ m{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isadigit{0}}\isanewline
\ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}P\ d\ v\ m\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ LeastI{\isacharunderscore}{\kern0pt}ex\ {\isadigit{0}}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ not{\isadigit{0}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ v\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}zero\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{obtain}\isamarkupfalse%
\ n{\isacharprime}{\kern0pt}\ \isakeyword{where}\ {\isachardoublequoteopen}{\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v\ m\ n{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex{\isacharbrackleft}{\kern0pt}OF\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ m{\isacharbrackright}{\kern0pt}\ assms\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}P\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ Suc\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ {\isacharparenleft}{\kern0pt}asm{\isacharparenright}{\kern0pt}\ Least{\isacharunderscore}{\kern0pt}Suc{\isacharparenright}{\kern0pt}\ auto\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ n{\isachardot}{\kern0pt}\ {\isacharquery}{\kern0pt}P\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}L{\isacharunderscore}{\kern0pt}pow\ v\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}m\ {\isadigit{0}}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}n{\isachardot}{\kern0pt}\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{3}}{\isacharparenright}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ mpi{\isacharunderscore}{\kern0pt}Suc{\isacharprime}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v\ m\ {\isacharequal}{\kern0pt}\ mpi\ d\ v\ m\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ Suc{\isachardot}{\kern0pt}prems{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ Suc{\isachardot}{\kern0pt}prems{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharminus}{\kern0pt}{\isadigit{4}}{\isacharparenright}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\ mpi{\isacharunderscore}{\kern0pt}Suc{\isacharprime}{\kern0pt}\ not{\isadigit{0}}\ L{\isacharunderscore}{\kern0pt}pow{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}inv\ \isacommand{by}\isamarkupfalse%
\ force\isanewline
\ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ Suc{\isachardot}{\kern0pt}prems{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ presburger\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}v{\isadigit{0}}\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v{\isadigit{0}}\ m{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharless}{\kern0pt}\ eps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}P\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}n{\isachardot}{\kern0pt}\ {\isadigit{2}}\ {\isacharasterisk}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ dist\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v{\isadigit{0}}\ m\ n{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}val\ d\ v{\isadigit{0}}\ m\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ \ eps\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}n\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}Least\ {\isacharquery}{\kern0pt}P{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}algo\ d\ v{\isadigit{0}}\ m\ {\isacharequal}{\kern0pt}\ mpi\ d\ v{\isadigit{0}}\ m\ {\isacharquery}{\kern0pt}n{\isachardoublequoteclose}\ \isakeyword{and}\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}P\ {\isacharquery}{\kern0pt}n{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}mpi\ LeastI{\isacharunderscore}{\kern0pt}ex{\isacharbrackleft}{\kern0pt}OF\ mpi{\isacharunderscore}{\kern0pt}val{\isacharunderscore}{\kern0pt}term{\isacharunderscore}{\kern0pt}ex{\isacharbrackright}{\kern0pt}\ assms\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}opt\ mpi{\isacharunderscore}{\kern0pt}pol{\isacharunderscore}{\kern0pt}def{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{Initial Value Estimate \isa{v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi}%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
We define an initial estimate of the value function for which Modified Policy Iteration 
  always terminates.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}min\ {\isasymequiv}\ {\isacharparenleft}{\kern0pt}{\isasymSqinter}s{\isacharprime}{\kern0pt}\ a{\isachardot}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}s{\isacharprime}{\kern0pt}{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\ s\ {\isacharequal}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}min\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ fastforce%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}rule\ less{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}bfunI{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}min\ {\isasymle}\ r\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ s\ a\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ cInf{\isacharunderscore}{\kern0pt}lower{\isadigit{2}}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}min\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}min{\isachardoublequoteclose}\ \isakeyword{for}\ s\ a\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ disc{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}one\ zero{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}disc\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}le\ order{\isacharunderscore}{\kern0pt}refl\ segment{\isacharunderscore}{\kern0pt}bound{\isacharunderscore}{\kern0pt}lemma{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}min\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharminus}{\kern0pt}l{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ r\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}min{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ s\ a\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ order{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}le{\isacharbrackleft}{\kern0pt}OF\ disc{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}one{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ divide{\isacharunderscore}{\kern0pt}right{\isacharunderscore}{\kern0pt}mono{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}r{\isacharunderscore}{\kern0pt}min\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}\ {\isasymle}\ r\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\ r{\isacharunderscore}{\kern0pt}min{\isacharparenright}{\kern0pt}\ {\isacharslash}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ {\isacharminus}{\kern0pt}\ l{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ s\ a\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ disc{\isacharunderscore}{\kern0pt}lt{\isacharunderscore}{\kern0pt}one\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ add{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}distrib{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b\ x\ {\isasymle}\ {\isasymL}\isactrlsub b\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}L\isactrlsub a\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ A{\isacharunderscore}{\kern0pt}ne\ intro{\isacharcolon}{\kern0pt}\ cSUP{\isacharunderscore}{\kern0pt}upper{\isadigit{2}}{\isacharbrackleft}{\kern0pt}\isakeyword{where}\ x\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}arb{\isacharunderscore}{\kern0pt}act\ {\isacharparenleft}{\kern0pt}A\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsubsection{An Instance of Modified Policy Iteration with a Valid Conservative Initial Value Estimate%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}user\ eps\ m\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ if\ eps\ {\isasymle}\ {\isadigit{0}}\ then\ undefined\ else\ mpi{\isacharunderscore}{\kern0pt}algo\ eps\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ arb{\isacharunderscore}{\kern0pt}act\ {\isacharparenleft}{\kern0pt}A\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b\ m{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}user{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}mpi{\isacharunderscore}{\kern0pt}user\ eps\ {\isacharequal}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}alg{\isacharunderscore}{\kern0pt}rec\ eps\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ arb{\isacharunderscore}{\kern0pt}act\ {\isacharparenleft}{\kern0pt}A\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}user{\isacharunderscore}{\kern0pt}def\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}def{\isacharprime}{\kern0pt}\ A{\isacharunderscore}{\kern0pt}ne\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}user{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}eps\ {\isachargreater}{\kern0pt}\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}dist\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}user\ eps\ n{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt\ {\isacharless}{\kern0pt}\ eps{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ mpi{\isacharunderscore}{\kern0pt}user{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ mpi{\isacharunderscore}{\kern0pt}algo{\isacharunderscore}{\kern0pt}opt\ simp{\isacharcolon}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def\ A{\isacharunderscore}{\kern0pt}ne\ v{\isadigit{0}}{\isacharunderscore}{\kern0pt}mpi\isactrlsub b{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Modified_Policy_Iteration.tex%:%
%:%6=1%:%
%:%7=2%:%
%:%12=3%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%16=6%:%
%:%17=7%:%
%:%31=9%:%
%:%41=11%:%
%:%42=11%:%
%:%43=12%:%
%:%44=13%:%
%:%51=15%:%
%:%61=17%:%
%:%62=17%:%
%:%64=19%:%
%:%65=20%:%
%:%67=22%:%
%:%68=22%:%
%:%75=23%:%
%:%76=23%:%
%:%77=24%:%
%:%78=24%:%
%:%79=25%:%
%:%80=25%:%
%:%81=26%:%
%:%82=26%:%
%:%83=27%:%
%:%84=27%:%
%:%85=28%:%
%:%86=28%:%
%:%87=29%:%
%:%88=29%:%
%:%89=30%:%
%:%90=30%:%
%:%91=31%:%
%:%92=31%:%
%:%93=32%:%
%:%94=32%:%
%:%95=33%:%
%:%96=33%:%
%:%97=34%:%
%:%98=34%:%
%:%99=35%:%
%:%100=35%:%
%:%101=36%:%
%:%102=36%:%
%:%103=37%:%
%:%104=37%:%
%:%105=38%:%
%:%106=38%:%
%:%107=39%:%
%:%108=39%:%
%:%109=40%:%
%:%110=40%:%
%:%111=41%:%
%:%121=43%:%
%:%123=45%:%
%:%124=45%:%
%:%127=46%:%
%:%131=46%:%
%:%132=46%:%
%:%133=47%:%
%:%134=47%:%
%:%139=47%:%
%:%142=48%:%
%:%143=49%:%
%:%144=49%:%
%:%147=50%:%
%:%151=50%:%
%:%152=50%:%
%:%157=50%:%
%:%160=51%:%
%:%161=52%:%
%:%162=52%:%
%:%165=53%:%
%:%169=53%:%
%:%170=53%:%
%:%171=54%:%
%:%172=54%:%
%:%186=56%:%
%:%196=58%:%
%:%197=58%:%
%:%199=60%:%
%:%200=61%:%
%:%202=63%:%
%:%203=63%:%
%:%206=64%:%
%:%210=64%:%
%:%211=64%:%
%:%212=65%:%
%:%213=65%:%
%:%218=65%:%
%:%221=66%:%
%:%222=67%:%
%:%223=67%:%
%:%226=68%:%
%:%230=68%:%
%:%231=68%:%
%:%232=69%:%
%:%233=69%:%
%:%238=69%:%
%:%241=70%:%
%:%242=71%:%
%:%243=71%:%
%:%250=72%:%
%:%251=72%:%
%:%252=73%:%
%:%253=73%:%
%:%254=74%:%
%:%255=74%:%
%:%256=75%:%
%:%257=75%:%
%:%258=76%:%
%:%259=76%:%
%:%260=77%:%
%:%261=77%:%
%:%262=77%:%
%:%263=78%:%
%:%264=78%:%
%:%265=79%:%
%:%266=80%:%
%:%267=80%:%
%:%268=80%:%
%:%269=81%:%
%:%270=81%:%
%:%271=81%:%
%:%272=82%:%
%:%273=82%:%
%:%274=83%:%
%:%275=83%:%
%:%276=84%:%
%:%277=84%:%
%:%278=85%:%
%:%284=85%:%
%:%287=86%:%
%:%288=87%:%
%:%289=87%:%
%:%296=88%:%
%:%297=88%:%
%:%298=89%:%
%:%299=89%:%
%:%300=90%:%
%:%301=90%:%
%:%302=91%:%
%:%303=91%:%
%:%304=92%:%
%:%305=92%:%
%:%306=93%:%
%:%307=93%:%
%:%308=94%:%
%:%309=94%:%
%:%310=95%:%
%:%311=95%:%
%:%312=96%:%
%:%313=96%:%
%:%314=96%:%
%:%315=97%:%
%:%316=97%:%
%:%317=98%:%
%:%318=98%:%
%:%319=98%:%
%:%320=99%:%
%:%321=99%:%
%:%322=100%:%
%:%323=100%:%
%:%324=100%:%
%:%325=101%:%
%:%326=101%:%
%:%327=102%:%
%:%328=102%:%
%:%329=103%:%
%:%330=103%:%
%:%331=103%:%
%:%332=104%:%
%:%333=104%:%
%:%334=105%:%
%:%335=105%:%
%:%336=105%:%
%:%337=106%:%
%:%338=106%:%
%:%339=107%:%
%:%340=107%:%
%:%341=108%:%
%:%342=108%:%
%:%343=108%:%
%:%344=109%:%
%:%345=109%:%
%:%346=110%:%
%:%347=110%:%
%:%348=111%:%
%:%349=111%:%
%:%350=111%:%
%:%351=112%:%
%:%352=112%:%
%:%353=113%:%
%:%354=113%:%
%:%355=114%:%
%:%356=114%:%
%:%357=114%:%
%:%358=115%:%
%:%359=115%:%
%:%360=116%:%
%:%361=116%:%
%:%362=116%:%
%:%363=116%:%
%:%364=117%:%
%:%365=117%:%
%:%366=118%:%
%:%367=118%:%
%:%368=119%:%
%:%369=119%:%
%:%370=120%:%
%:%371=120%:%
%:%372=120%:%
%:%373=121%:%
%:%374=121%:%
%:%375=122%:%
%:%376=122%:%
%:%377=122%:%
%:%378=123%:%
%:%379=123%:%
%:%380=124%:%
%:%381=124%:%
%:%382=125%:%
%:%383=125%:%
%:%384=126%:%
%:%385=126%:%
%:%386=127%:%
%:%392=127%:%
%:%395=128%:%
%:%396=129%:%
%:%397=129%:%
%:%398=130%:%
%:%399=131%:%
%:%406=132%:%
%:%407=132%:%
%:%408=133%:%
%:%409=133%:%
%:%410=134%:%
%:%411=134%:%
%:%412=135%:%
%:%413=135%:%
%:%414=136%:%
%:%415=136%:%
%:%416=137%:%
%:%417=138%:%
%:%418=138%:%
%:%419=139%:%
%:%420=139%:%
%:%421=140%:%
%:%422=140%:%
%:%423=141%:%
%:%429=141%:%
%:%432=142%:%
%:%433=143%:%
%:%434=143%:%
%:%437=144%:%
%:%441=144%:%
%:%442=144%:%
%:%447=144%:%
%:%450=145%:%
%:%451=146%:%
%:%452=146%:%
%:%453=147%:%
%:%454=148%:%
%:%461=149%:%
%:%462=149%:%
%:%463=150%:%
%:%464=150%:%
%:%465=151%:%
%:%466=151%:%
%:%467=152%:%
%:%468=152%:%
%:%469=153%:%
%:%470=153%:%
%:%471=154%:%
%:%472=154%:%
%:%473=155%:%
%:%474=155%:%
%:%475=156%:%
%:%476=156%:%
%:%477=157%:%
%:%478=157%:%
%:%479=158%:%
%:%480=158%:%
%:%481=159%:%
%:%482=159%:%
%:%483=160%:%
%:%484=160%:%
%:%485=161%:%
%:%486=161%:%
%:%487=162%:%
%:%488=162%:%
%:%489=163%:%
%:%490=163%:%
%:%491=164%:%
%:%492=164%:%
%:%493=165%:%
%:%499=165%:%
%:%502=166%:%
%:%503=167%:%
%:%504=167%:%
%:%511=168%:%
%:%512=168%:%
%:%513=169%:%
%:%514=169%:%
%:%515=170%:%
%:%516=170%:%
%:%517=171%:%
%:%518=171%:%
%:%519=172%:%
%:%520=172%:%
%:%521=173%:%
%:%522=173%:%
%:%523=174%:%
%:%529=174%:%
%:%532=175%:%
%:%533=176%:%
%:%534=177%:%
%:%535=177%:%
%:%536=178%:%
%:%537=179%:%
%:%540=180%:%
%:%544=180%:%
%:%545=180%:%
%:%546=181%:%
%:%547=181%:%
%:%548=182%:%
%:%553=182%:%
%:%556=183%:%
%:%557=184%:%
%:%558=185%:%
%:%559=185%:%
%:%566=186%:%
%:%567=186%:%
%:%568=187%:%
%:%569=187%:%
%:%570=188%:%
%:%571=188%:%
%:%572=189%:%
%:%573=189%:%
%:%574=190%:%
%:%575=190%:%
%:%576=190%:%
%:%577=191%:%
%:%578=191%:%
%:%579=192%:%
%:%580=192%:%
%:%581=193%:%
%:%582=193%:%
%:%583=194%:%
%:%584=194%:%
%:%585=195%:%
%:%586=195%:%
%:%587=196%:%
%:%588=196%:%
%:%589=197%:%
%:%590=197%:%
%:%591=198%:%
%:%592=198%:%
%:%593=199%:%
%:%594=199%:%
%:%595=200%:%
%:%596=200%:%
%:%597=201%:%
%:%598=201%:%
%:%599=202%:%
%:%600=202%:%
%:%601=203%:%
%:%602=203%:%
%:%603=203%:%
%:%604=204%:%
%:%605=204%:%
%:%606=205%:%
%:%607=205%:%
%:%608=206%:%
%:%609=206%:%
%:%610=206%:%
%:%611=207%:%
%:%612=207%:%
%:%613=208%:%
%:%614=208%:%
%:%615=209%:%
%:%621=209%:%
%:%624=210%:%
%:%625=211%:%
%:%626=211%:%
%:%629=212%:%
%:%633=212%:%
%:%634=212%:%
%:%635=213%:%
%:%636=213%:%
%:%641=213%:%
%:%644=214%:%
%:%645=215%:%
%:%646=215%:%
%:%649=216%:%
%:%653=216%:%
%:%654=216%:%
%:%655=217%:%
%:%656=217%:%
%:%661=217%:%
%:%664=218%:%
%:%665=219%:%
%:%666=219%:%
%:%673=220%:%
%:%674=220%:%
%:%675=221%:%
%:%676=221%:%
%:%677=222%:%
%:%678=222%:%
%:%679=223%:%
%:%680=223%:%
%:%681=223%:%
%:%682=224%:%
%:%683=224%:%
%:%684=225%:%
%:%685=225%:%
%:%686=225%:%
%:%687=225%:%
%:%688=226%:%
%:%703=228%:%
%:%715=229%:%
%:%716=230%:%
%:%717=231%:%
%:%718=232%:%
%:%720=234%:%
%:%721=234%:%
%:%722=235%:%
%:%723=236%:%
%:%724=237%:%
%:%725=237%:%
%:%726=238%:%
%:%727=239%:%
%:%734=240%:%
%:%735=240%:%
%:%736=241%:%
%:%737=241%:%
%:%738=242%:%
%:%739=242%:%
%:%740=242%:%
%:%741=243%:%
%:%742=243%:%
%:%743=244%:%
%:%744=244%:%
%:%745=245%:%
%:%746=245%:%
%:%747=245%:%
%:%748=246%:%
%:%749=246%:%
%:%750=247%:%
%:%751=247%:%
%:%752=248%:%
%:%753=248%:%
%:%754=248%:%
%:%755=249%:%
%:%756=249%:%
%:%757=250%:%
%:%758=250%:%
%:%759=250%:%
%:%760=251%:%
%:%761=251%:%
%:%762=252%:%
%:%763=252%:%
%:%764=252%:%
%:%765=253%:%
%:%766=253%:%
%:%767=254%:%
%:%768=254%:%
%:%769=254%:%
%:%770=255%:%
%:%771=255%:%
%:%772=255%:%
%:%773=256%:%
%:%774=256%:%
%:%775=256%:%
%:%776=256%:%
%:%777=257%:%
%:%783=257%:%
%:%786=258%:%
%:%787=259%:%
%:%788=259%:%
%:%789=260%:%
%:%790=261%:%
%:%797=262%:%
%:%798=262%:%
%:%799=263%:%
%:%800=263%:%
%:%801=264%:%
%:%802=264%:%
%:%803=265%:%
%:%804=265%:%
%:%805=266%:%
%:%806=266%:%
%:%807=267%:%
%:%808=267%:%
%:%809=268%:%
%:%810=268%:%
%:%811=269%:%
%:%812=269%:%
%:%813=270%:%
%:%814=270%:%
%:%815=271%:%
%:%821=271%:%
%:%824=272%:%
%:%825=273%:%
%:%826=273%:%
%:%827=274%:%
%:%828=275%:%
%:%835=276%:%
%:%836=276%:%
%:%837=277%:%
%:%838=277%:%
%:%839=278%:%
%:%840=278%:%
%:%841=279%:%
%:%842=279%:%
%:%843=280%:%
%:%844=280%:%
%:%845=280%:%
%:%846=281%:%
%:%847=281%:%
%:%848=282%:%
%:%849=282%:%
%:%850=283%:%
%:%851=283%:%
%:%852=283%:%
%:%853=283%:%
%:%854=284%:%
%:%860=284%:%
%:%863=285%:%
%:%864=286%:%
%:%865=286%:%
%:%866=287%:%
%:%867=288%:%
%:%874=289%:%
%:%875=289%:%
%:%876=290%:%
%:%877=290%:%
%:%878=291%:%
%:%879=291%:%
%:%880=292%:%
%:%881=292%:%
%:%882=293%:%
%:%883=293%:%
%:%884=293%:%
%:%885=294%:%
%:%886=294%:%
%:%887=295%:%
%:%888=295%:%
%:%889=296%:%
%:%890=296%:%
%:%891=296%:%
%:%892=297%:%
%:%893=297%:%
%:%894=298%:%
%:%900=298%:%
%:%903=299%:%
%:%904=300%:%
%:%905=300%:%
%:%906=301%:%
%:%907=302%:%
%:%914=303%:%
%:%915=303%:%
%:%916=304%:%
%:%917=304%:%
%:%918=305%:%
%:%919=305%:%
%:%920=306%:%
%:%921=306%:%
%:%922=306%:%
%:%923=307%:%
%:%924=307%:%
%:%925=308%:%
%:%926=308%:%
%:%927=308%:%
%:%928=309%:%
%:%929=309%:%
%:%930=310%:%
%:%931=310%:%
%:%932=310%:%
%:%933=311%:%
%:%934=311%:%
%:%935=312%:%
%:%936=312%:%
%:%937=312%:%
%:%938=313%:%
%:%939=313%:%
%:%940=313%:%
%:%941=314%:%
%:%942=314%:%
%:%943=314%:%
%:%944=314%:%
%:%945=315%:%
%:%946=315%:%
%:%947=315%:%
%:%948=316%:%
%:%949=316%:%
%:%950=317%:%
%:%965=319%:%
%:%975=320%:%
%:%976=320%:%
%:%977=321%:%
%:%978=322%:%
%:%979=323%:%
%:%980=323%:%
%:%983=324%:%
%:%987=324%:%
%:%988=324%:%
%:%989=325%:%
%:%990=325%:%
%:%995=325%:%
%:%998=326%:%
%:%999=327%:%
%:%1000=328%:%
%:%1001=328%:%
%:%1002=329%:%
%:%1003=330%:%
%:%1010=331%:%
%:%1011=331%:%
%:%1012=332%:%
%:%1013=332%:%
%:%1014=333%:%
%:%1015=333%:%
%:%1016=334%:%
%:%1017=334%:%
%:%1018=335%:%
%:%1019=335%:%
%:%1020=336%:%
%:%1021=336%:%
%:%1022=336%:%
%:%1023=337%:%
%:%1024=337%:%
%:%1025=338%:%
%:%1026=338%:%
%:%1027=338%:%
%:%1028=339%:%
%:%1029=339%:%
%:%1030=340%:%
%:%1031=340%:%
%:%1032=340%:%
%:%1033=341%:%
%:%1034=341%:%
%:%1035=342%:%
%:%1036=342%:%
%:%1037=342%:%
%:%1038=343%:%
%:%1039=343%:%
%:%1040=344%:%
%:%1041=344%:%
%:%1042=344%:%
%:%1043=344%:%
%:%1044=345%:%
%:%1045=345%:%
%:%1046=345%:%
%:%1047=346%:%
%:%1048=346%:%
%:%1049=347%:%
%:%1050=347%:%
%:%1051=347%:%
%:%1052=348%:%
%:%1053=348%:%
%:%1054=349%:%
%:%1060=349%:%
%:%1063=350%:%
%:%1064=351%:%
%:%1065=351%:%
%:%1066=352%:%
%:%1067=353%:%
%:%1070=354%:%
%:%1074=354%:%
%:%1075=354%:%
%:%1076=355%:%
%:%1077=355%:%
%:%1082=355%:%
%:%1085=356%:%
%:%1086=357%:%
%:%1087=357%:%
%:%1088=358%:%
%:%1089=359%:%
%:%1092=360%:%
%:%1096=360%:%
%:%1097=360%:%
%:%1098=361%:%
%:%1099=361%:%
%:%1113=363%:%
%:%1123=364%:%
%:%1124=364%:%
%:%1125=365%:%
%:%1126=366%:%
%:%1127=367%:%
%:%1128=368%:%
%:%1129=369%:%
%:%1131=371%:%
%:%1133=372%:%
%:%1134=372%:%
%:%1135=373%:%
%:%1136=374%:%
%:%1138=376%:%
%:%1139=377%:%
%:%1140=378%:%
%:%1141=378%:%
%:%1142=379%:%
%:%1143=379%:%
%:%1144=380%:%
%:%1145=381%:%
%:%1146=381%:%
%:%1149=382%:%
%:%1153=382%:%
%:%1154=382%:%
%:%1155=383%:%
%:%1156=383%:%
%:%1161=383%:%
%:%1164=384%:%
%:%1165=385%:%
%:%1166=385%:%
%:%1169=386%:%
%:%1173=386%:%
%:%1174=386%:%
%:%1179=386%:%
%:%1182=387%:%
%:%1183=388%:%
%:%1184=388%:%
%:%1187=389%:%
%:%1191=389%:%
%:%1192=389%:%
%:%1193=390%:%
%:%1194=390%:%
%:%1195=391%:%
%:%1196=391%:%
%:%1201=391%:%
%:%1204=392%:%
%:%1205=393%:%
%:%1206=393%:%
%:%1209=394%:%
%:%1213=394%:%
%:%1214=394%:%
%:%1215=395%:%
%:%1216=395%:%
%:%1221=395%:%
%:%1224=396%:%
%:%1225=397%:%
%:%1226=397%:%
%:%1229=398%:%
%:%1233=398%:%
%:%1234=398%:%
%:%1235=398%:%
%:%1240=398%:%
%:%1243=399%:%
%:%1244=400%:%
%:%1245=400%:%
%:%1248=401%:%
%:%1252=401%:%
%:%1253=401%:%
%:%1254=402%:%
%:%1255=402%:%
%:%1260=402%:%
%:%1263=403%:%
%:%1264=404%:%
%:%1265=404%:%
%:%1266=405%:%
%:%1269=406%:%
%:%1273=406%:%
%:%1274=406%:%
%:%1275=407%:%
%:%1276=407%:%
%:%1285=410%:%
%:%1287=411%:%
%:%1288=411%:%
%:%1289=412%:%
%:%1290=413%:%
%:%1293=414%:%
%:%1297=414%:%
%:%1298=414%:%
%:%1299=415%:%
%:%1300=415%:%
%:%1314=417%:%
%:%1326=418%:%
%:%1328=419%:%
%:%1329=419%:%
%:%1330=420%:%
%:%1331=421%:%
%:%1332=422%:%
%:%1333=423%:%
%:%1334=423%:%
%:%1337=424%:%
%:%1341=424%:%
%:%1342=424%:%
%:%1343=425%:%
%:%1348=425%:%
%:%1351=426%:%
%:%1352=427%:%
%:%1353=427%:%
%:%1356=428%:%
%:%1360=428%:%
%:%1361=428%:%
%:%1366=428%:%
%:%1369=429%:%
%:%1370=430%:%
%:%1371=430%:%
%:%1378=431%:%
%:%1379=431%:%
%:%1380=432%:%
%:%1381=432%:%
%:%1382=433%:%
%:%1383=433%:%
%:%1384=434%:%
%:%1385=434%:%
%:%1386=435%:%
%:%1387=435%:%
%:%1388=435%:%
%:%1389=436%:%
%:%1390=436%:%
%:%1391=437%:%
%:%1401=439%:%
%:%1402=440%:%
%:%1404=441%:%
%:%1405=441%:%
%:%1406=442%:%
%:%1407=443%:%
%:%1414=444%:%
%:%1415=444%:%
%:%1416=445%:%
%:%1417=445%:%
%:%1418=446%:%
%:%1419=446%:%
%:%1420=447%:%
%:%1421=447%:%
%:%1422=448%:%
%:%1423=448%:%
%:%1424=449%:%
%:%1425=449%:%
%:%1426=450%:%
%:%1427=450%:%
%:%1428=451%:%
%:%1429=451%:%
%:%1430=452%:%
%:%1431=452%:%
%:%1432=453%:%
%:%1433=453%:%
%:%1434=454%:%
%:%1435=454%:%
%:%1436=455%:%
%:%1437=455%:%
%:%1438=456%:%
%:%1439=456%:%
%:%1440=457%:%
%:%1441=457%:%
%:%1442=458%:%
%:%1443=458%:%
%:%1444=459%:%
%:%1445=459%:%
%:%1446=459%:%
%:%1447=460%:%
%:%1448=460%:%
%:%1449=460%:%
%:%1450=461%:%
%:%1451=461%:%
%:%1452=462%:%
%:%1453=462%:%
%:%1454=463%:%
%:%1455=463%:%
%:%1456=463%:%
%:%1457=464%:%
%:%1458=464%:%
%:%1459=465%:%
%:%1460=465%:%
%:%1461=466%:%
%:%1462=466%:%
%:%1463=466%:%
%:%1464=467%:%
%:%1465=467%:%
%:%1466=468%:%
%:%1467=468%:%
%:%1468=469%:%
%:%1469=469%:%
%:%1470=469%:%
%:%1471=470%:%
%:%1472=470%:%
%:%1473=471%:%
%:%1474=471%:%
%:%1475=472%:%
%:%1476=472%:%
%:%1477=473%:%
%:%1478=473%:%
%:%1479=474%:%
%:%1480=474%:%
%:%1481=475%:%
%:%1482=475%:%
%:%1483=475%:%
%:%1484=476%:%
%:%1485=476%:%
%:%1486=477%:%
%:%1487=477%:%
%:%1488=478%:%
%:%1489=478%:%
%:%1490=479%:%
%:%1505=481%:%
%:%1517=482%:%
%:%1519=483%:%
%:%1520=483%:%
%:%1521=484%:%
%:%1522=485%:%
%:%1529=486%:%
%:%1530=486%:%
%:%1531=487%:%
%:%1532=487%:%
%:%1533=488%:%
%:%1534=488%:%
%:%1535=489%:%
%:%1536=489%:%
%:%1537=490%:%
%:%1538=490%:%
%:%1539=491%:%
%:%1540=491%:%
%:%1541=492%:%
%:%1542=492%:%
%:%1543=493%:%
%:%1544=493%:%
%:%1545=493%:%
%:%1546=494%:%
%:%1547=494%:%
%:%1548=495%:%
%:%1549=495%:%
%:%1550=495%:%
%:%1551=496%:%
%:%1552=496%:%
%:%1553=497%:%
%:%1554=497%:%
%:%1555=498%:%
%:%1556=498%:%
%:%1557=498%:%
%:%1558=499%:%
%:%1559=499%:%
%:%1560=499%:%
%:%1561=500%:%
%:%1562=500%:%
%:%1563=500%:%
%:%1564=501%:%
%:%1565=501%:%
%:%1566=501%:%
%:%1567=502%:%
%:%1568=502%:%
%:%1569=502%:%
%:%1570=502%:%
%:%1571=503%:%
%:%1572=503%:%
%:%1573=504%:%
%:%1574=504%:%
%:%1575=505%:%
%:%1576=505%:%
%:%1577=506%:%
%:%1578=506%:%
%:%1579=507%:%
%:%1580=507%:%
%:%1581=508%:%
%:%1582=508%:%
%:%1583=509%:%
%:%1584=509%:%
%:%1585=510%:%
%:%1586=510%:%
%:%1587=511%:%
%:%1588=511%:%
%:%1589=512%:%
%:%1590=512%:%
%:%1591=513%:%
%:%1592=513%:%
%:%1593=514%:%
%:%1594=514%:%
%:%1595=515%:%
%:%1596=515%:%
%:%1597=516%:%
%:%1598=516%:%
%:%1599=517%:%
%:%1600=517%:%
%:%1601=518%:%
%:%1602=518%:%
%:%1603=519%:%
%:%1604=519%:%
%:%1605=519%:%
%:%1606=520%:%
%:%1607=520%:%
%:%1608=521%:%
%:%1609=521%:%
%:%1610=522%:%
%:%1611=522%:%
%:%1612=522%:%
%:%1613=523%:%
%:%1614=523%:%
%:%1615=524%:%
%:%1616=524%:%
%:%1617=525%:%
%:%1618=525%:%
%:%1619=525%:%
%:%1620=525%:%
%:%1621=526%:%
%:%1622=526%:%
%:%1623=527%:%
%:%1629=527%:%
%:%1632=528%:%
%:%1633=529%:%
%:%1634=529%:%
%:%1635=530%:%
%:%1636=531%:%
%:%1643=532%:%
%:%1644=532%:%
%:%1645=533%:%
%:%1646=533%:%
%:%1647=534%:%
%:%1648=534%:%
%:%1649=535%:%
%:%1650=535%:%
%:%1651=536%:%
%:%1652=536%:%
%:%1653=537%:%
%:%1654=537%:%
%:%1655=538%:%
%:%1661=538%:%
%:%1664=539%:%
%:%1665=540%:%
%:%1666=540%:%
%:%1667=541%:%
%:%1668=542%:%
%:%1675=543%:%
%:%1676=543%:%
%:%1677=544%:%
%:%1678=544%:%
%:%1679=545%:%
%:%1680=545%:%
%:%1681=546%:%
%:%1682=546%:%
%:%1683=547%:%
%:%1684=547%:%
%:%1685=548%:%
%:%1686=548%:%
%:%1687=549%:%
%:%1688=549%:%
%:%1689=550%:%
%:%1690=550%:%
%:%1691=551%:%
%:%1692=551%:%
%:%1693=552%:%
%:%1694=552%:%
%:%1695=553%:%
%:%1696=553%:%
%:%1697=554%:%
%:%1698=554%:%
%:%1699=555%:%
%:%1700=555%:%
%:%1701=556%:%
%:%1702=556%:%
%:%1703=557%:%
%:%1704=557%:%
%:%1705=558%:%
%:%1711=558%:%
%:%1714=559%:%
%:%1722=561%:%
%:%1732=562%:%
%:%1733=562%:%
%:%1734=563%:%
%:%1735=564%:%
%:%1736=565%:%
%:%1737=566%:%
%:%1738=566%:%
%:%1741=569%:%
%:%1744=570%:%
%:%1748=570%:%
%:%1749=570%:%
%:%1758=572%:%
%:%1760=573%:%
%:%1761=573%:%
%:%1762=574%:%
%:%1763=575%:%
%:%1764=576%:%
%:%1765=577%:%
%:%1766=578%:%
%:%1767=578%:%
%:%1768=579%:%
%:%1769=580%:%
%:%1772=581%:%
%:%1776=581%:%
%:%1777=581%:%
%:%1778=582%:%
%:%1779=582%:%
%:%1784=582%:%
%:%1787=583%:%
%:%1788=584%:%
%:%1789=584%:%
%:%1790=585%:%
%:%1791=586%:%
%:%1794=587%:%
%:%1798=587%:%
%:%1799=587%:%
%:%1800=588%:%
%:%1801=588%:%
%:%1802=589%:%
%:%1803=589%:%
%:%1804=590%:%
%:%1805=590%:%
%:%1806=591%:%
%:%1807=591%:%
%:%1808=592%:%
%:%1809=592%:%
%:%1810=593%:%
%:%1811=593%:%
%:%1816=593%:%
%:%1819=594%:%
%:%1820=595%:%
%:%1821=595%:%
%:%1822=596%:%
%:%1823=597%:%
%:%1830=598%:%
%:%1831=598%:%
%:%1832=599%:%
%:%1833=599%:%
%:%1834=600%:%
%:%1835=600%:%
%:%1836=601%:%
%:%1837=601%:%
%:%1838=602%:%
%:%1839=602%:%
%:%1840=602%:%
%:%1841=603%:%
%:%1842=603%:%
%:%1843=604%:%
%:%1844=604%:%
%:%1845=605%:%
%:%1846=605%:%
%:%1847=606%:%
%:%1848=606%:%
%:%1849=607%:%
%:%1850=607%:%
%:%1851=608%:%
%:%1852=608%:%
%:%1853=609%:%
%:%1854=609%:%
%:%1855=610%:%
%:%1856=610%:%
%:%1857=611%:%
%:%1858=611%:%
%:%1859=612%:%
%:%1860=612%:%
%:%1861=613%:%
%:%1862=613%:%
%:%1863=614%:%
%:%1864=614%:%
%:%1865=615%:%
%:%1866=615%:%
%:%1867=616%:%
%:%1868=616%:%
%:%1869=617%:%
%:%1870=617%:%
%:%1871=618%:%
%:%1872=618%:%
%:%1873=619%:%
%:%1874=619%:%
%:%1876=621%:%
%:%1877=622%:%
%:%1878=622%:%
%:%1879=623%:%
%:%1880=623%:%
%:%1881=624%:%
%:%1882=624%:%
%:%1883=625%:%
%:%1884=625%:%
%:%1885=625%:%
%:%1886=626%:%
%:%1887=626%:%
%:%1888=626%:%
%:%1889=627%:%
%:%1890=627%:%
%:%1891=627%:%
%:%1892=628%:%
%:%1893=628%:%
%:%1894=628%:%
%:%1895=629%:%
%:%1896=629%:%
%:%1897=630%:%
%:%1898=630%:%
%:%1899=631%:%
%:%1900=631%:%
%:%1901=632%:%
%:%1907=632%:%
%:%1910=633%:%
%:%1911=634%:%
%:%1912=634%:%
%:%1915=637%:%
%:%1916=638%:%
%:%1917=639%:%
%:%1918=639%:%
%:%1919=640%:%
%:%1920=641%:%
%:%1923=642%:%
%:%1927=642%:%
%:%1928=642%:%
%:%1929=643%:%
%:%1930=643%:%
%:%1935=643%:%
%:%1938=644%:%
%:%1939=645%:%
%:%1940=645%:%
%:%1941=646%:%
%:%1942=647%:%
%:%1949=648%:%
%:%1950=648%:%
%:%1951=649%:%
%:%1952=649%:%
%:%1953=650%:%
%:%1954=650%:%
%:%1955=650%:%
%:%1956=651%:%
%:%1957=651%:%
%:%1958=652%:%
%:%1959=652%:%
%:%1960=653%:%
%:%1961=653%:%
%:%1962=654%:%
%:%1963=654%:%
%:%1964=655%:%
%:%1965=655%:%
%:%1966=656%:%
%:%1967=656%:%
%:%1968=657%:%
%:%1969=657%:%
%:%1970=658%:%
%:%1971=658%:%
%:%1972=659%:%
%:%1973=659%:%
%:%1974=660%:%
%:%1975=660%:%
%:%1976=661%:%
%:%1977=661%:%
%:%1978=662%:%
%:%1979=662%:%
%:%1980=663%:%
%:%1981=663%:%
%:%1982=664%:%
%:%1983=664%:%
%:%1984=664%:%
%:%1985=665%:%
%:%1986=665%:%
%:%1987=666%:%
%:%1988=666%:%
%:%1989=667%:%
%:%1990=667%:%
%:%1991=668%:%
%:%1992=668%:%
%:%1993=669%:%
%:%1994=669%:%
%:%1995=670%:%
%:%1996=670%:%
%:%1997=671%:%
%:%1998=671%:%
%:%1999=672%:%
%:%2000=672%:%
%:%2001=673%:%
%:%2002=673%:%
%:%2003=673%:%
%:%2004=674%:%
%:%2005=674%:%
%:%2006=675%:%
%:%2007=675%:%
%:%2008=675%:%
%:%2009=676%:%
%:%2010=676%:%
%:%2011=677%:%
%:%2017=677%:%
%:%2020=678%:%
%:%2021=679%:%
%:%2022=679%:%
%:%2023=680%:%
%:%2024=681%:%
%:%2031=682%:%
%:%2032=682%:%
%:%2033=683%:%
%:%2034=683%:%
%:%2035=684%:%
%:%2036=684%:%
%:%2037=685%:%
%:%2038=685%:%
%:%2039=686%:%
%:%2040=686%:%
%:%2041=686%:%
%:%2042=687%:%
%:%2043=687%:%
%:%2044=688%:%
%:%2045=688%:%
%:%2046=689%:%
%:%2047=689%:%
%:%2048=690%:%
%:%2054=690%:%
%:%2057=691%:%
%:%2058=692%:%
%:%2066=695%:%
%:%2078=696%:%
%:%2079=697%:%
%:%2081=699%:%
%:%2082=699%:%
%:%2083=700%:%
%:%2084=700%:%
%:%2085=701%:%
%:%2086=702%:%
%:%2087=702%:%
%:%2090=703%:%
%:%2094=703%:%
%:%2095=703%:%
%:%2100=703%:%
%:%2103=704%:%
%:%2104=705%:%
%:%2105=705%:%
%:%2112=706%:%
%:%2113=706%:%
%:%2114=707%:%
%:%2115=707%:%
%:%2116=708%:%
%:%2117=708%:%
%:%2118=709%:%
%:%2119=709%:%
%:%2120=710%:%
%:%2121=710%:%
%:%2122=711%:%
%:%2123=711%:%
%:%2124=712%:%
%:%2125=712%:%
%:%2126=713%:%
%:%2127=713%:%
%:%2128=714%:%
%:%2129=714%:%
%:%2130=715%:%
%:%2131=715%:%
%:%2132=716%:%
%:%2133=716%:%
%:%2134=717%:%
%:%2135=717%:%
%:%2136=718%:%
%:%2137=718%:%
%:%2138=719%:%
%:%2139=719%:%
%:%2140=720%:%
%:%2141=720%:%
%:%2142=721%:%
%:%2143=721%:%
%:%2144=722%:%
%:%2159=724%:%
%:%2169=725%:%
%:%2170=725%:%
%:%2171=726%:%
%:%2172=727%:%
%:%2173=728%:%
%:%2174=728%:%
%:%2175=729%:%
%:%2176=730%:%
%:%2179=731%:%
%:%2183=731%:%
%:%2184=731%:%
%:%2185=732%:%
%:%2186=732%:%
%:%2191=732%:%
%:%2194=733%:%
%:%2195=734%:%
%:%2196=734%:%
%:%2197=735%:%
%:%2198=736%:%
%:%2201=737%:%
%:%2205=737%:%
%:%2206=737%:%
%:%2207=737%:%
%:%2208=738%:%
%:%2209=738%:%
%:%2214=738%:%
%:%2217=739%:%
%:%2218=740%:%
%:%2219=740%:%
%:%2222=741%:%
%:%2227=742%:%

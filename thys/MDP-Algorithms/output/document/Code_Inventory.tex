%
\begin{isabellebody}%
\setisabellecontext{Code{\isacharunderscore}{\kern0pt}Inventory}%
%
\isadelimtheory
\isanewline
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Code{\isacharunderscore}{\kern0pt}Inventory\isanewline
\ \ \isakeyword{imports}\ \isanewline
\ \ \ \ Code{\isacharunderscore}{\kern0pt}Mod\isanewline
\ \ \isanewline
\ \ \ \ Code{\isacharunderscore}{\kern0pt}Real{\isacharunderscore}{\kern0pt}Approx{\isacharunderscore}{\kern0pt}By{\isacharunderscore}{\kern0pt}Float{\isacharunderscore}{\kern0pt}Fix\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Inventory Management Example%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code\ abstype{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}embed{\isacharunderscore}{\kern0pt}pmf\ {\isacharparenleft}{\kern0pt}pmf\ P{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ P{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ td{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}embed{\isacharunderscore}{\kern0pt}pmf\ type{\isacharunderscore}{\kern0pt}definition{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemmas}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}abbrev\ del{\isacharbrackright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ pmf{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharunderscore}{\kern0pt}unfold{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ P\ {\isacharparenleft}{\kern0pt}f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ enum\ {\isasymRightarrow}\ real{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ UNIV{\isachardot}{\kern0pt}\ pmf\ P\ x\ {\isacharasterisk}{\kern0pt}\ f\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}no{\isacharunderscore}{\kern0pt}types{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}\ UNIV{\isacharunderscore}{\kern0pt}I\ finite{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}finite{\isacharunderscore}{\kern0pt}UNIV\ integral{\isacharunderscore}{\kern0pt}measure{\isacharunderscore}{\kern0pt}pmf\ \isanewline
\ \ \ \ \ \ real{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}def\ sum{\isachardot}{\kern0pt}cong{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}pmf\ {\isacharparenleft}{\kern0pt}return{\isacharunderscore}{\kern0pt}pmf\ x{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}y{\isachardot}{\kern0pt}\ indicat{\isacharunderscore}{\kern0pt}real\ {\isacharbraceleft}{\kern0pt}y{\isacharbraceright}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isacharbrackleft}{\kern0pt}code{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}pmf\ {\isacharparenleft}{\kern0pt}bind{\isacharunderscore}{\kern0pt}pmf\ N\ f{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}a{\isachardot}{\kern0pt}\ measure{\isacharunderscore}{\kern0pt}pmf{\isachardot}{\kern0pt}expectation\ N\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}b\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}enum{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ pmf\ {\isacharparenleft}{\kern0pt}f\ x{\isacharparenright}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ Probability{\isacharunderscore}{\kern0pt}Mass{\isacharunderscore}{\kern0pt}Function{\isachardot}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}bind\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ fast%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pmf{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}le{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}X\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}finite{\isacharparenright}{\kern0pt}\ set{\isacharparenright}{\kern0pt}\ {\isasymLongrightarrow}\ sum\ {\isacharparenleft}{\kern0pt}pmf\ p{\isacharparenright}{\kern0pt}\ X\ {\isasymle}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}subst\ sum{\isacharunderscore}{\kern0pt}pmf{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharbrackleft}{\kern0pt}symmetric{\isacharcomma}{\kern0pt}\ of\ UNIV\ p{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}mono{\isadigit{2}}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}diff{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isacharless}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharbraceleft}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type{\isacharbraceright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}x\ {\isasymle}\ y{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}y\ {\isacharminus}{\kern0pt}\ x\ {\isacharless}{\kern0pt}\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isadigit{0}}\ {\isasymle}\ Rep\ y\ {\isacharminus}{\kern0pt}\ Rep\ x{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ mono{\isacharunderscore}{\kern0pt}Rep\ \isacommand{unfolding}\isamarkupfalse%
\ mono{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isadigit{1}}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}Rep\ y\ {\isacharminus}{\kern0pt}\ Rep\ x\ {\isacharequal}{\kern0pt}\ Rep\ {\isacharparenleft}{\kern0pt}y\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ mod{\isacharunderscore}{\kern0pt}type{\isacharunderscore}{\kern0pt}class{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}def\ Rep{\isacharunderscore}{\kern0pt}Abs{\isacharunderscore}{\kern0pt}mod\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ Rep{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}pos{\isacharunderscore}{\kern0pt}trivial{\isacharbrackleft}{\kern0pt}OF\ {\isacartoucheopen}{\isadigit{0}}\ {\isasymle}\ Rep\ y\ {\isacharminus}{\kern0pt}\ Rep\ x{\isacartoucheclose}\ order{\isachardot}{\kern0pt}strict{\isacharunderscore}{\kern0pt}trans{\isadigit{1}}{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ Rep{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}n{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ y{\isacharbrackright}{\kern0pt}{\isacharcomma}{\kern0pt}\ symmetric{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Rep\ y\ {\isacharminus}{\kern0pt}\ Rep\ x\ {\isacharless}{\kern0pt}\ Rep\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ strict{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}Rep\ Rep{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{0}}\ le{\isacharunderscore}{\kern0pt}less\ not{\isacharunderscore}{\kern0pt}less\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ strict{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}Rep\ {\isacharparenleft}{\kern0pt}y\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ Rep\ y{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isadigit{1}}\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ not{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}iff{\isacharunderscore}{\kern0pt}gr{\isacharunderscore}{\kern0pt}or{\isacharunderscore}{\kern0pt}eq\ strict{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}Rep\ strict{\isacharunderscore}{\kern0pt}mono{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{locale}\isamarkupfalse%
\ inventory\ {\isacharequal}{\kern0pt}\isanewline
\ \ \isakeyword{fixes}\ fixed{\isacharunderscore}{\kern0pt}cost\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ real\isanewline
\ \ \ \ \isakeyword{and}\ var{\isacharunderscore}{\kern0pt}cost\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharbraceleft}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type{\isacharcomma}{\kern0pt}\ finite{\isacharbraceright}{\kern0pt}\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ inv{\isacharunderscore}{\kern0pt}cost\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ pmf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ revenue\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ discount\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}real{\isachardoublequoteclose}\isanewline
\isakeyword{begin}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}order{\isacharunderscore}{\kern0pt}cost\ u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ u\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{0}}\ else\ fixed{\isacharunderscore}{\kern0pt}cost\ {\isacharplus}{\kern0pt}\ var{\isacharunderscore}{\kern0pt}cost\ u{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ u\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isacharless}{\kern0pt}u{\isachardot}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}exp{\isacharunderscore}{\kern0pt}rev\ u\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isacharless}{\kern0pt}u{\isachardot}{\kern0pt}\ revenue\ j\ {\isacharasterisk}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ j{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ revenue\ u\ {\isacharasterisk}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ u{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}reward\ sa\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}case\ sa\ of\ {\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ exp{\isacharunderscore}{\kern0pt}rev\ {\isacharparenleft}{\kern0pt}s\ {\isacharplus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ {\isacharminus}{\kern0pt}\ order{\isacharunderscore}{\kern0pt}cost\ a\ {\isacharminus}{\kern0pt}\ inv{\isacharunderscore}{\kern0pt}cost\ {\isacharparenleft}{\kern0pt}s\ {\isacharplus}{\kern0pt}\ a{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ transition\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymtimes}\ {\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}s\ pmf{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}{\isacharparenleft}{\kern0pt}s{\isacharcomma}{\kern0pt}\ a{\isacharparenright}{\kern0pt}\ s{\isacharprime}{\kern0pt}{\isachardot}{\kern0pt}\ \isanewline
\ \ {\isacharparenleft}{\kern0pt}if\ CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}\ {\isasymle}\ Rep\ s\ {\isacharplus}{\kern0pt}\ Rep\ a\ \isanewline
\ \ then\ {\isacharparenleft}{\kern0pt}if\ s{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}{\isacharparenright}{\kern0pt}\isanewline
\ \ else\ {\isacharparenleft}{\kern0pt}if\ s\ {\isacharplus}{\kern0pt}\ a\ {\isacharless}{\kern0pt}\ s{\isacharprime}{\kern0pt}\ then\ {\isadigit{0}}\ else\isanewline
\ \ \ if\ s{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}s{\isacharplus}{\kern0pt}a{\isacharparenright}{\kern0pt}\isanewline
\ \ \ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}s\ {\isacharplus}{\kern0pt}\ a\ {\isacharminus}{\kern0pt}\ s{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ {\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}safe{\isacharcomma}{\kern0pt}\ goal{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}\ a\ b\ x{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\ \isacommand{unfolding}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}def\ \isacommand{using}\isamarkupfalse%
\ pmf{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}le\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{case}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}{\isadigit{2}}\ a\ b{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{then}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}case\isanewline
\ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}cases\ {\isachardoublequoteopen}int\ CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}\ {\isasymle}\ Rep\ a\ {\isacharplus}{\kern0pt}\ Rep\ b{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\ \ \isacommand{next}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{case}\isamarkupfalse%
\ False\isanewline
\ \ \ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymintegral}\isactrlsup {\isacharplus}{\kern0pt}\ x{\isachardot}{\kern0pt}\ ennreal\ {\isacharparenleft}{\kern0pt}if\ int\ CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}\ {\isasymle}\ Rep\ a\ {\isacharplus}{\kern0pt}\ Rep\ b\ then\ if\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ {\isadigit{1}}\ else\ {\isadigit{0}}\ else\ if\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ x\ then\ {\isadigit{0}}\ else\ if\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasympartial}count{\isacharunderscore}{\kern0pt}space\ UNIV{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\isanewline
\ \ \ \ \ \ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ UNIV{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ x\ then\ {\isadigit{0}}\ else\ if\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{using}\isamarkupfalse%
\ pmf{\isacharunderscore}{\kern0pt}nonneg\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}def\ pmf{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}le\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ nn{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}finite\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ sum{\isacharunderscore}{\kern0pt}ennreal{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ UNIV{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ x\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}\ then\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ else\ if\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ x\ then\ {\isadigit{0}}\ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ sum{\isachardot}{\kern0pt}cong\ ennreal{\isacharunderscore}{\kern0pt}cong\ simp\ add{\isacharcolon}{\kern0pt}\ leD\ least{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x\ {\isasymin}\ UNIV{\isacharminus}{\kern0pt}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ x\ then\ {\isadigit{0}}\ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ sum{\isachardot}{\kern0pt}remove{\isacharbrackleft}{\kern0pt}of\ UNIV\ {\isadigit{0}}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}if\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharless}{\kern0pt}\ x\ then\ {\isadigit{0}}\ else\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ greaterThan{\isacharunderscore}{\kern0pt}def\ le{\isacharunderscore}{\kern0pt}neq{\isacharunderscore}{\kern0pt}trans\ least{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cong{\isacharbrackleft}{\kern0pt}of\ {\isachardoublequoteopen}sum\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ ennreal{\isacharunderscore}{\kern0pt}cong{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}a{\isacharplus}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ atMost{\isacharunderscore}{\kern0pt}def\ greaterThan{\isacharunderscore}{\kern0pt}def\ greaterThanAtMost{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Collect{\isacharunderscore}{\kern0pt}neg{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ not{\isacharunderscore}{\kern0pt}less\ sum{\isachardot}{\kern0pt}If{\isacharunderscore}{\kern0pt}cases{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ \ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isacharless}{\kern0pt}{\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ j{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}a{\isacharplus}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ \ {\isadigit{1}}\ {\isacharminus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}j{\isacharless}{\kern0pt}{\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ j{\isacharparenright}{\kern0pt}\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}a{\isacharplus}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pmf\ demand{\isacharunderscore}{\kern0pt}prob\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}a{\isacharplus}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ pmf\ demand{\isacharunderscore}{\kern0pt}prob\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}x{\isasymin}{\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}a{\isacharplus}{\kern0pt}b{\isacharbraceright}{\kern0pt}{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}pmf\ demand{\isacharunderscore}{\kern0pt}prob\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ sum{\isachardot}{\kern0pt}reindex{\isacharunderscore}{\kern0pt}bij{\isacharunderscore}{\kern0pt}betw\ bij{\isacharunderscore}{\kern0pt}betw{\isacharunderscore}{\kern0pt}imageI{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}inj{\isacharunderscore}{\kern0pt}on\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ inj{\isacharunderscore}{\kern0pt}on{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}cancel\ diff{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}cancel{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ {\isacharparenleft}{\kern0pt}b\ {\isacharplus}{\kern0pt}\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isachardot}{\kern0pt}assoc\ add{\isachardot}{\kern0pt}commute\ add{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ add{\isachardot}{\kern0pt}left{\isacharunderscore}{\kern0pt}neutral\ diff{\isacharunderscore}{\kern0pt}add{\isacharunderscore}{\kern0pt}cancel\ least{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type\ less{\isacharunderscore}{\kern0pt}le{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isasymLongrightarrow}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x\ {\isasymle}\ a\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ diff{\isacharunderscore}{\kern0pt}{\isadigit{0}}{\isacharunderscore}{\kern0pt}right\ least{\isacharunderscore}{\kern0pt}mod{\isacharunderscore}{\kern0pt}type\ less{\isacharunderscore}{\kern0pt}le\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}diff\ not{\isacharunderscore}{\kern0pt}less{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}x\ {\isacharless}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isasymLongrightarrow}\ {\isasymexists}xa{\isachardot}{\kern0pt}\ x\ {\isacharequal}{\kern0pt}\ a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ xa\ {\isasymand}\ {\isadigit{0}}\ {\isacharless}{\kern0pt}\ xa\ {\isasymand}\ xa\ {\isasymle}\ a\ {\isacharplus}{\kern0pt}\ b{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ algebra{\isacharunderscore}{\kern0pt}simps\ intro{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}a\ {\isacharplus}{\kern0pt}\ b\ {\isacharminus}{\kern0pt}\ x{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharminus}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharparenright}{\kern0pt}\ {\isacharbackquote}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharless}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isachardot}{\kern0pt}{\isachardot}{\kern0pt}{\isacharless}{\kern0pt}a\ {\isacharplus}{\kern0pt}\ b{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
\ \ \ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ mod{\isacharunderscore}{\kern0pt}less{\isacharunderscore}{\kern0pt}diff{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\ \isanewline
\ \ \ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{qed}\isamarkupfalse%
\isanewline
\ \ \ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymdots}\ {\isacharequal}{\kern0pt}\ \ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\ \ \ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
\isanewline
\ \ \isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ nn{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}A{\isacharunderscore}{\kern0pt}inv\ {\isacharparenleft}{\kern0pt}s{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}s{\isachardot}{\kern0pt}\ Rep\ s\ {\isacharplus}{\kern0pt}\ Rep\ a\ {\isacharless}{\kern0pt}\ CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}var{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}lin\ {\isacharparenleft}{\kern0pt}c{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ Rep\ n{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}lin\ {\isacharparenleft}{\kern0pt}c{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ Rep\ n{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}revenue{\isacharunderscore}{\kern0pt}lin\ {\isacharparenleft}{\kern0pt}c{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}real{\isacharparenright}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ c\ {\isacharasterisk}{\kern0pt}\ Rep\ n{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ demand{\isacharunderscore}{\kern0pt}unif\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}finite{\isacharparenright}{\kern0pt}\ pmf{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}{\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{1}}\ {\isacharslash}{\kern0pt}\ card\ {\isacharparenleft}{\kern0pt}UNIV{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a\ set{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ ennreal{\isacharunderscore}{\kern0pt}divide{\isacharunderscore}{\kern0pt}times\ divide{\isacharunderscore}{\kern0pt}ennreal{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ ennreal{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}real{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}nat{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lift{\isacharunderscore}{\kern0pt}definition}\isamarkupfalse%
\ demand{\isacharunderscore}{\kern0pt}three\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}\ pmf{\isachardoublequoteclose}\ \isakeyword{is}\ {\isachardoublequoteopen}{\isasymlambda}i{\isachardot}{\kern0pt}\ if\ i\ {\isacharequal}{\kern0pt}\ {\isadigit{1}}\ then\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{4}}\ else\ if\ i\ {\isacharequal}{\kern0pt}\ {\isadigit{2}}\ then\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{2}}\ else\ {\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{4}}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}UNIV\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isadigit{3}}\ set{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}{\isadigit{0}}{\isacharcomma}{\kern0pt}{\isadigit{1}}{\isacharcomma}{\kern0pt}{\isadigit{2}}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ exhaust{\isacharunderscore}{\kern0pt}{\isadigit{3}}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{apply}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ nn{\isacharunderscore}{\kern0pt}integral{\isacharunderscore}{\kern0pt}count{\isacharunderscore}{\kern0pt}space{\isacharunderscore}{\kern0pt}finite{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ {\isacharasterisk}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}fixed{\isacharunderscore}{\kern0pt}cost\ {\isasymequiv}\ {\isadigit{4}}{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}var{\isacharunderscore}{\kern0pt}cost\ {\isasymequiv}\ var{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}lin\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}inv{\isacharunderscore}{\kern0pt}cost\ {\isasymequiv}\ inv{\isacharunderscore}{\kern0pt}cost{\isacharunderscore}{\kern0pt}lin\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}revenue\ {\isasymequiv}\ revenue{\isacharunderscore}{\kern0pt}lin\ {\isadigit{8}}{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}discount\ {\isasymequiv}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isadigit{9}}{\isadigit{9}}{\isachardoublequoteclose}\isanewline
\isacommand{type{\isacharunderscore}{\kern0pt}synonym}\isamarkupfalse%
\ capacity\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isadigit{3}}{\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ card{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}ne{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymge}\ {\isadigit{2}}\ {\isasymLongrightarrow}\ {\isasymexists}{\isacharparenleft}{\kern0pt}x{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}finite{\isacharparenright}{\kern0pt}\ y{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}{\isacharprime}{\kern0pt}a{\isachardot}{\kern0pt}\ x\ {\isasymnoteq}\ y{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}meson\ card{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}iff{\isacharprime}{\kern0pt}\ ex{\isacharunderscore}{\kern0pt}card{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{global{\isacharunderscore}{\kern0pt}interpretation}\isamarkupfalse%
\ inventory{\isacharunderscore}{\kern0pt}ex{\isacharcolon}{\kern0pt}\ inventory\ fixed{\isacharunderscore}{\kern0pt}cost\ {\isachardoublequoteopen}var{\isacharunderscore}{\kern0pt}cost{\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ capacity\ {\isasymRightarrow}\ real{\isachardoublequoteclose}\ inv{\isacharunderscore}{\kern0pt}cost\ demand{\isacharunderscore}{\kern0pt}unif\ revenue\ discount\isanewline
\ \ \isakeyword{defines}\ A{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}A{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeyword{and}\ transition\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}transition\isanewline
\ \ \ \ \isakeyword{and}\ reward\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}reward\isanewline
\ \ \ \ \isakeyword{and}\ prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}prob{\isacharunderscore}{\kern0pt}ge{\isacharunderscore}{\kern0pt}inv\isanewline
\ \ \ \ \isakeyword{and}\ order{\isacharunderscore}{\kern0pt}cost\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}order{\isacharunderscore}{\kern0pt}cost\isanewline
\ \ \ \ \isakeyword{and}\ exp{\isacharunderscore}{\kern0pt}rev\ {\isacharequal}{\kern0pt}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}exp{\isacharunderscore}{\kern0pt}rev%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{{\isachardot}{\kern0pt}}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}K\ {\isasymequiv}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}transition{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}A\ {\isasymequiv}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}A{\isacharunderscore}{\kern0pt}inv{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}r\ {\isasymequiv}\ inventory{\isacharunderscore}{\kern0pt}ex{\isachardot}{\kern0pt}reward{\isachardoublequoteclose}\isanewline
\isacommand{abbreviation}\isamarkupfalse%
\ {\isachardoublequoteopen}l\ {\isasymequiv}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isadigit{9}}{\isadigit{5}}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}eps\ {\isacharequal}{\kern0pt}\ {\isadigit{0}}{\isachardot}{\kern0pt}{\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ f\ {\isacharequal}{\kern0pt}\ map\ f\ {\isacharparenleft}{\kern0pt}sorted{\isacharunderscore}{\kern0pt}list{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}set\ UNIV{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}gs\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ Rep\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}vi{\isacharunderscore}{\kern0pt}policy{\isacharprime}{\kern0pt}\ K\ A\ r\ l\ eps\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}vi\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ Rep\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}vi{\isacharunderscore}{\kern0pt}gs{\isacharunderscore}{\kern0pt}policy\ K\ A\ r\ l\ eps\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}mpi\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit\ {\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ Rep\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}fst\ {\isacharparenleft}{\kern0pt}mpi{\isacharunderscore}{\kern0pt}user\ K\ A\ r\ l\ eps\ {\isacharparenleft}{\kern0pt}{\isasymlambda}{\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}{\isachardot}{\kern0pt}\ {\isadigit{3}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}pi\ {\isacharparenleft}{\kern0pt}{\isacharunderscore}{\kern0pt}\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ unit{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ map\ Rep\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}iteration\ K\ A\ r\ l\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{fun}\isamarkupfalse%
\ vs{\isacharunderscore}{\kern0pt}n\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}vs{\isacharunderscore}{\kern0pt}n\ {\isadigit{0}}\ v\ {\isacharequal}{\kern0pt}\ v{\isachardoublequoteclose}\isanewline
{\isacharbar}{\kern0pt}\ {\isachardoublequoteopen}vs{\isacharunderscore}{\kern0pt}n\ {\isacharparenleft}{\kern0pt}Suc\ n{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}n\ n\ {\isacharparenleft}{\kern0pt}mod{\isacharunderscore}{\kern0pt}MDP{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ K\ A\ r\ l\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}vs{\isacharunderscore}{\kern0pt}n{\isacharprime}{\kern0pt}\ n\ {\isacharequal}{\kern0pt}\ vs{\isacharunderscore}{\kern0pt}n\ n\ {\isadigit{0}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}vi{\isacharunderscore}{\kern0pt}n\ n\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}vs{\isacharunderscore}{\kern0pt}n\ n\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}benchmark{\isacharunderscore}{\kern0pt}vi{\isacharunderscore}{\kern0pt}nopol\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}list\ {\isacharparenleft}{\kern0pt}mod{\isacharunderscore}{\kern0pt}MDP{\isacharunderscore}{\kern0pt}value{\isacharunderscore}{\kern0pt}iteration\ K\ A\ r\ l\ {\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharslash}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isacharparenright}{\kern0pt}\ {\isadigit{0}}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isanewline
\isanewline
\isacommand{export{\isacharunderscore}{\kern0pt}code}\isamarkupfalse%
\ dist\ vs{\isacharunderscore}{\kern0pt}n{\isacharprime}{\kern0pt}\ benchmark{\isacharunderscore}{\kern0pt}vi{\isacharunderscore}{\kern0pt}nopol\ benchmark{\isacharunderscore}{\kern0pt}vi{\isacharunderscore}{\kern0pt}n\ nat{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}integer\ integer{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ benchmark{\isacharunderscore}{\kern0pt}gs\ benchmark{\isacharunderscore}{\kern0pt}vi\ benchmark{\isacharunderscore}{\kern0pt}mpi\ benchmark{\isacharunderscore}{\kern0pt}pi\isanewline
\ \ \isakeyword{in}\ Haskell\ \isakeyword{module{\isacharunderscore}{\kern0pt}name}\ DP\isanewline
\isanewline
\isacommand{export{\isacharunderscore}{\kern0pt}code}\isamarkupfalse%
\ integer{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}int\ benchmark{\isacharunderscore}{\kern0pt}gs\ benchmark{\isacharunderscore}{\kern0pt}vi\ benchmark{\isacharunderscore}{\kern0pt}mpi\ benchmark{\isacharunderscore}{\kern0pt}pi\ \isakeyword{in}\ SML\ \isakeyword{module{\isacharunderscore}{\kern0pt}name}\ DP\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Code_Inventory.tex%:%
%:%6=1%:%
%:%7=2%:%
%:%12=3%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%16=6%:%
%:%17=7%:%
%:%18=8%:%
%:%32=10%:%
%:%42=12%:%
%:%43=12%:%
%:%46=13%:%
%:%50=13%:%
%:%51=13%:%
%:%56=13%:%
%:%59=14%:%
%:%60=15%:%
%:%61=15%:%
%:%62=16%:%
%:%63=17%:%
%:%64=17%:%
%:%65=18%:%
%:%68=19%:%
%:%72=19%:%
%:%73=19%:%
%:%74=20%:%
%:%79=20%:%
%:%82=21%:%
%:%83=22%:%
%:%84=22%:%
%:%87=23%:%
%:%91=23%:%
%:%92=23%:%
%:%97=23%:%
%:%100=24%:%
%:%101=25%:%
%:%102=25%:%
%:%103=26%:%
%:%106=27%:%
%:%110=27%:%
%:%111=27%:%
%:%112=28%:%
%:%113=28%:%
%:%118=28%:%
%:%121=29%:%
%:%122=30%:%
%:%123=30%:%
%:%126=31%:%
%:%130=31%:%
%:%131=31%:%
%:%136=31%:%
%:%139=32%:%
%:%140=33%:%
%:%141=33%:%
%:%142=34%:%
%:%143=35%:%
%:%150=36%:%
%:%151=36%:%
%:%152=37%:%
%:%153=37%:%
%:%154=38%:%
%:%155=38%:%
%:%156=38%:%
%:%157=39%:%
%:%158=39%:%
%:%159=40%:%
%:%160=40%:%
%:%161=41%:%
%:%162=41%:%
%:%163=42%:%
%:%164=42%:%
%:%165=43%:%
%:%166=43%:%
%:%167=44%:%
%:%168=44%:%
%:%169=45%:%
%:%170=45%:%
%:%171=46%:%
%:%172=46%:%
%:%173=47%:%
%:%174=47%:%
%:%175=48%:%
%:%176=48%:%
%:%177=48%:%
%:%178=49%:%
%:%179=49%:%
%:%180=50%:%
%:%181=50%:%
%:%182=51%:%
%:%188=51%:%
%:%191=52%:%
%:%192=53%:%
%:%193=53%:%
%:%194=54%:%
%:%195=55%:%
%:%196=56%:%
%:%197=57%:%
%:%198=58%:%
%:%199=59%:%
%:%200=60%:%
%:%201=61%:%
%:%202=61%:%
%:%203=62%:%
%:%204=62%:%
%:%205=63%:%
%:%206=63%:%
%:%207=64%:%
%:%208=64%:%
%:%209=65%:%
%:%210=65%:%
%:%216=71%:%
%:%223=72%:%
%:%224=72%:%
%:%225=73%:%
%:%226=73%:%
%:%227=74%:%
%:%228=74%:%
%:%229=74%:%
%:%230=74%:%
%:%231=74%:%
%:%232=74%:%
%:%233=75%:%
%:%234=75%:%
%:%235=76%:%
%:%236=76%:%
%:%237=77%:%
%:%238=77%:%
%:%239=77%:%
%:%240=78%:%
%:%241=78%:%
%:%242=78%:%
%:%243=79%:%
%:%244=79%:%
%:%245=80%:%
%:%246=80%:%
%:%247=81%:%
%:%248=82%:%
%:%249=82%:%
%:%250=83%:%
%:%251=83%:%
%:%252=84%:%
%:%253=84%:%
%:%254=84%:%
%:%255=85%:%
%:%256=85%:%
%:%257=86%:%
%:%258=86%:%
%:%259=86%:%
%:%260=87%:%
%:%261=87%:%
%:%262=88%:%
%:%263=88%:%
%:%264=88%:%
%:%265=89%:%
%:%266=89%:%
%:%267=90%:%
%:%268=90%:%
%:%269=90%:%
%:%270=91%:%
%:%271=91%:%
%:%272=92%:%
%:%273=92%:%
%:%274=93%:%
%:%275=93%:%
%:%276=93%:%
%:%277=94%:%
%:%278=94%:%
%:%279=95%:%
%:%280=95%:%
%:%281=96%:%
%:%282=96%:%
%:%283=96%:%
%:%284=97%:%
%:%285=97%:%
%:%286=98%:%
%:%287=98%:%
%:%288=99%:%
%:%289=99%:%
%:%290=100%:%
%:%291=100%:%
%:%292=101%:%
%:%293=101%:%
%:%294=102%:%
%:%295=102%:%
%:%296=103%:%
%:%297=103%:%
%:%298=104%:%
%:%299=104%:%
%:%300=105%:%
%:%301=105%:%
%:%302=105%:%
%:%303=106%:%
%:%304=106%:%
%:%305=107%:%
%:%306=107%:%
%:%307=107%:%
%:%308=108%:%
%:%309=108%:%
%:%310=109%:%
%:%311=109%:%
%:%312=109%:%
%:%313=110%:%
%:%314=110%:%
%:%315=111%:%
%:%316=111%:%
%:%317=112%:%
%:%318=112%:%
%:%319=113%:%
%:%320=113%:%
%:%321=114%:%
%:%322=114%:%
%:%323=115%:%
%:%324=115%:%
%:%325=116%:%
%:%326=116%:%
%:%327=117%:%
%:%328=117%:%
%:%329=117%:%
%:%330=118%:%
%:%331=118%:%
%:%332=119%:%
%:%333=119%:%
%:%334=119%:%
%:%335=119%:%
%:%336=120%:%
%:%337=120%:%
%:%338=121%:%
%:%344=121%:%
%:%347=122%:%
%:%348=123%:%
%:%349=123%:%
%:%350=124%:%
%:%351=125%:%
%:%352=125%:%
%:%353=126%:%
%:%354=127%:%
%:%355=127%:%
%:%356=128%:%
%:%357=128%:%
%:%358=129%:%
%:%359=129%:%
%:%360=130%:%
%:%361=131%:%
%:%362=131%:%
%:%365=132%:%
%:%369=132%:%
%:%370=132%:%
%:%375=132%:%
%:%378=133%:%
%:%379=134%:%
%:%380=134%:%
%:%387=135%:%
%:%388=135%:%
%:%389=136%:%
%:%390=136%:%
%:%391=137%:%
%:%392=137%:%
%:%393=138%:%
%:%394=138%:%
%:%395=139%:%
%:%396=139%:%
%:%397=140%:%
%:%398=140%:%
%:%399=141%:%
%:%400=141%:%
%:%401=142%:%
%:%402=142%:%
%:%403=143%:%
%:%409=143%:%
%:%412=144%:%
%:%413=145%:%
%:%414=145%:%
%:%415=146%:%
%:%416=146%:%
%:%417=147%:%
%:%418=147%:%
%:%419=148%:%
%:%420=148%:%
%:%421=149%:%
%:%422=149%:%
%:%423=150%:%
%:%424=150%:%
%:%425=151%:%
%:%426=152%:%
%:%427=152%:%
%:%430=153%:%
%:%434=153%:%
%:%435=153%:%
%:%440=153%:%
%:%443=154%:%
%:%444=155%:%
%:%445=155%:%
%:%446=156%:%
%:%447=157%:%
%:%448=158%:%
%:%449=159%:%
%:%450=160%:%
%:%451=161%:%
%:%457=161%:%
%:%465=161%:%
%:%466=162%:%
%:%467=163%:%
%:%468=163%:%
%:%469=164%:%
%:%470=164%:%
%:%471=165%:%
%:%472=165%:%
%:%473=166%:%
%:%474=166%:%
%:%475=167%:%
%:%476=167%:%
%:%477=168%:%
%:%478=169%:%
%:%479=169%:%
%:%480=170%:%
%:%481=170%:%
%:%482=171%:%
%:%483=171%:%
%:%484=172%:%
%:%485=172%:%
%:%486=173%:%
%:%487=173%:%
%:%488=174%:%
%:%489=175%:%
%:%490=175%:%
%:%491=176%:%
%:%492=177%:%
%:%493=178%:%
%:%494=179%:%
%:%495=179%:%
%:%496=180%:%
%:%497=181%:%
%:%498=181%:%
%:%499=182%:%
%:%500=182%:%
%:%501=183%:%
%:%502=189%:%
%:%503=190%:%
%:%504=191%:%
%:%505=192%:%
%:%506=192%:%
%:%507=193%:%
%:%508=194%:%
%:%509=195%:%
%:%510=195%:%
%:%513=196%:%
%:%518=197%:%

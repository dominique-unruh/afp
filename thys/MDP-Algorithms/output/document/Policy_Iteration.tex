%
\begin{isabellebody}%
\setisabellecontext{Policy{\isacharunderscore}{\kern0pt}Iteration}%
%
\isadelimtheory
\isanewline
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ Policy{\isacharunderscore}{\kern0pt}Iteration\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}MDP{\isacharminus}{\kern0pt}Rewards{\isachardot}{\kern0pt}MDP{\isacharunderscore}{\kern0pt}reward{\isachardoublequoteclose}\isanewline
\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isadelimdocument
%
\endisadelimdocument
%
\isatagdocument
%
\isamarkupsection{Policy Iteration%
}
\isamarkuptrue%
%
\endisatagdocument
{\isafolddocument}%
%
\isadelimdocument
%
\endisadelimdocument
%
\begin{isamarkuptext}%
The Policy Iteration algorithms provides another way to find optimal policies under the expected 
total reward criterion.
It differs from Value Iteration in that it continuously improves an initial guess for an optimal 
decision rule. Its execution can be subdivided into two alternating steps: policy evaluation and 
policy improvement.

Policy evaluation means the calculation of the value of the current decision rule.

During the improvement phase, we choose the decision rule with the maximum value for L, 
while we prefer to keep the old action selection in case of ties.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{context}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}att{\isacharunderscore}{\kern0pt}{\isasymL}\ \isakeyword{begin}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}act\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ if\ is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ L\isactrlsub a\ a\ {\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ v{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ A\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}d\ s{\isacharparenright}{\kern0pt}\ \isanewline
\ \ then\ d\ s\isanewline
\ \ else\ arb{\isacharunderscore}{\kern0pt}act\ {\isacharparenleft}{\kern0pt}opt{\isacharunderscore}{\kern0pt}acts\ v\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}step\ d\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}improvement\ d\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{function}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}iteration\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}a{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{where}\isanewline
\ \ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}iteration\ d\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}\isanewline
\ \ let\ d{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step\ d\ in\isanewline
\ \ if\ d\ {\isacharequal}{\kern0pt}\ d{\isacharprime}{\kern0pt}\ {\isasymor}\ {\isasymnot}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d\ then\ d\ else\ policy{\isacharunderscore}{\kern0pt}iteration\ d{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The policy iteration algorithm as stated above does require that the supremum in \isa{{\isasymL}\isactrlsub b} is
always attained.%
\end{isamarkuptext}\isamarkuptrue%
%
\begin{isamarkuptext}%
Each policy improvement returns a valid decision rule.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ some{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}acts{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D\ {\isasymLongrightarrow}\ policy{\isacharunderscore}{\kern0pt}improvement\ d\ v\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}def\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ some{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}acts{\isacharunderscore}{\kern0pt}in{\isacharunderscore}{\kern0pt}A\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ auto%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}improving{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnu}{\isacharunderscore}{\kern0pt}improving\ v\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymL}\isactrlsub b\ v\ x\ {\isacharequal}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ v\ x{\isachardoublequoteclose}\ \isakeyword{for}\ x\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}act{\isacharunderscore}{\kern0pt}some\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ simp{\isacharcolon}{\kern0pt}\ thm{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isadigit{0}}{\isacharunderscore}{\kern0pt}a{\isacharunderscore}{\kern0pt}aux{\isacharprime}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L\isactrlsub a{\isacharunderscore}{\kern0pt}det\ is{\isacharunderscore}{\kern0pt}opt{\isacharunderscore}{\kern0pt}act{\isacharunderscore}{\kern0pt}def\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \ \ \ \ arg{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}SUP{\isacharbrackleft}{\kern0pt}symmetric{\isacharcomma}{\kern0pt}\ of\ {\isacharunderscore}{\kern0pt}\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}improvement\ d\ v\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ {\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}alt{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}L{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}{\isacharunderscore}{\kern0pt}improving{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b{\isacharbrackleft}{\kern0pt}OF\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}improving{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The sequence of policies generated by policy iteration has monotonically increasing 
discounted reward.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}mon{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isasymle}\ policy{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}dp\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ d{\isachardoublequoteclose}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}P\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isasymSum}t{\isachardot}{\kern0pt}\ l\ {\isacharcircum}{\kern0pt}\ t\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ t{\isachardoublequoteclose}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}\ {\isasymle}\ L\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ L{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}{\isasymL}\isactrlsub b\ eval{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}L{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isasymle}\ L\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}dp\ {\isasymle}\ r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}dp{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\ L{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharunderscore}{\kern0pt}blinfun\ {\isacharminus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}dp{\isacharparenright}{\kern0pt}\ {\isasymle}\ r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}diff{\isacharunderscore}{\kern0pt}left\ diff{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}eq\ scaleR{\isacharunderscore}{\kern0pt}blinfun{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharquery}{\kern0pt}P\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharunderscore}{\kern0pt}blinfun\ {\isacharminus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}dp{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharquery}{\kern0pt}P\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ lemma{\isacharunderscore}{\kern0pt}{\isadigit{6}}{\isacharunderscore}{\kern0pt}{\isadigit{1}}{\isacharunderscore}{\kern0pt}{\isadigit{2}}{\isacharunderscore}{\kern0pt}b\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isasymnu}\isactrlsub b\ {\isacharquery}{\kern0pt}dp\ {\isasymle}\ {\isacharquery}{\kern0pt}P\ {\isacharparenleft}{\kern0pt}r{\isacharunderscore}{\kern0pt}dec\isactrlsub b\ {\isacharquery}{\kern0pt}d{\isacharprime}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ inv{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}le{\isacharprime}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}OF\ norm{\isacharunderscore}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}{\isacharunderscore}{\kern0pt}l{\isacharunderscore}{\kern0pt}less{\isacharbrackright}{\kern0pt}\ blincomp{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ suminf{\isacharunderscore}{\kern0pt}cong\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ {\isacharparenleft}{\kern0pt}mono{\isacharunderscore}{\kern0pt}tags{\isacharcomma}{\kern0pt}\ lifting{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}{\isacharunderscore}{\kern0pt}stationary{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
If policy iteration terminates, i.e. \isa{d\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step\ d}, then it does so with optimal value.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}opt{\isacharcolon}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}d\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step\ d{\isachardoublequoteclose}\ \isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix\ assms\ eval{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}L{\isacharbrackleft}{\kern0pt}unfolded\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ fastforce\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isasymL}{\isacharunderscore}{\kern0pt}fix{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}opt\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
%
\begin{isamarkuptext}%
We prove termination of policy iteration only if both the state and action sets are finite.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{locale}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}PI{\isacharunderscore}{\kern0pt}finite\ {\isacharequal}{\kern0pt}\ MDP{\isacharunderscore}{\kern0pt}act\ A\ K\ r\ l\ arb{\isacharunderscore}{\kern0pt}act\isanewline
\ \ \isakeyword{for}\isanewline
\ \ \ \ A\ \isakeyword{and}\isanewline
\ \ \ \ K\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}countable\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}countable\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}s\ pmf{\isachardoublequoteclose}\ \isakeyword{and}\ r\ l\ arb{\isacharunderscore}{\kern0pt}act\ {\isacharplus}{\kern0pt}\isanewline
\ \ \isakeyword{assumes}\ fin{\isacharunderscore}{\kern0pt}states{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}UNIV\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}s\ set{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{and}\ fin{\isacharunderscore}{\kern0pt}actions{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymAnd}s{\isachardot}{\kern0pt}\ finite\ {\isacharparenleft}{\kern0pt}A\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\begin{isamarkuptext}%
If the state and action sets are both finite, 
  then so is the set of deterministic decision rules \isa{D\isactrlsub D}%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}D\isactrlsub D{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ D\isactrlsub D{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{let}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}set\ {\isacharequal}{\kern0pt}\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}d{\isachardot}{\kern0pt}\ {\isasymforall}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}s{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}x\ {\isasymin}\ UNIV\ {\isasymlongrightarrow}\ d\ x\ {\isasymin}\ {\isacharparenleft}{\kern0pt}{\isasymUnion}s{\isachardot}{\kern0pt}\ A\ s{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymand}\ {\isacharparenleft}{\kern0pt}x\ {\isasymnotin}\ UNIV\ {\isasymlongrightarrow}\ d\ x\ {\isacharequal}{\kern0pt}\ undefined{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharparenleft}{\kern0pt}{\isasymUnion}s{\isachardot}{\kern0pt}\ A\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}actions\ fin{\isacharunderscore}{\kern0pt}states\ \isacommand{by}\isamarkupfalse%
\ blast\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}finite\ {\isacharquery}{\kern0pt}set{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ fin{\isacharunderscore}{\kern0pt}states\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}of{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}funs{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{moreover}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}D\isactrlsub D\ {\isasymsubseteq}\ {\isacharquery}{\kern0pt}set{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{ultimately}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}subset\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}rel{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ u\ {\isasymand}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ v\ {\isasymand}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ u{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ \isanewline
\ \ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
{\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ aux{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}finite\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ u\ {\isasymand}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ v{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}subset{\isacharbrackleft}{\kern0pt}OF\ {\isacharunderscore}{\kern0pt}\ aux{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
This auxiliary lemma shows that policy iteration terminates if no improvement to the value of 
the policy could be made, as then the policy remains unchanged.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eq{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{assumes}\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}d\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step\ d{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ s\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\ \isakeyword{for}\ s\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}{\isacharbrackleft}{\kern0pt}symmetric{\isacharcomma}{\kern0pt}\ unfolded\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}metis\ L{\isacharunderscore}{\kern0pt}{\isasymnu}{\isacharunderscore}{\kern0pt}fix\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\ assms\ eval{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}L{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}\ s\ {\isacharequal}{\kern0pt}\ {\isasymL}\isactrlsub b\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ d{\isacharparenright}{\kern0pt}\ s{\isachardoublequoteclose}\ \isakeyword{for}\ s\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ {\isacartoucheopen}policy{\isacharunderscore}{\kern0pt}eval\ d\ {\isacharequal}{\kern0pt}\ L\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eval\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacartoucheclose}\ assms{\isacharparenleft}{\kern0pt}{\isadigit{1}}{\isacharparenright}{\kern0pt}\ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ L\isactrlsub a\ a\ {\isacharparenleft}{\kern0pt}{\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}a{\isachardot}{\kern0pt}\ a\ {\isasymin}\ A\ s{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}d\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isakeyword{for}\ s\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ L{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}L\isactrlsub a{\isacharunderscore}{\kern0pt}det\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ {\isasymL}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}det\ SUP{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}eq\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ assms{\isacharparenleft}{\kern0pt}{\isadigit{2}}{\isacharparenright}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}def\ L\isactrlsub a{\isacharunderscore}{\kern0pt}le\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ del{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ simp{\isacharcolon}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ boundedI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}r\isactrlsub M\ {\isacharplus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\ norm\ {\isacharunderscore}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}bdd{\isacharunderscore}{\kern0pt}above{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def\ policy{\isacharunderscore}{\kern0pt}improvement{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
We are now ready to prove termination in the context of finite state-action spaces.
Intuitively, the algorithm terminates as there are only finitely many decision rules,
and in each recursive call the value of the decision rule increases.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{termination}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}iteration\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}relation\ {\isachardoublequoteopen}{\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ u\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ v\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ u{\isacharparenright}{\kern0pt}\ {\isachargreater}{\kern0pt}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ v{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}wf\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ u\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ v\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ u{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ finite{\isacharunderscore}{\kern0pt}rel\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ finite{\isacharunderscore}{\kern0pt}acyclic{\isacharunderscore}{\kern0pt}wf\ acyclicI{\isacharunderscore}{\kern0pt}order{\isacharparenright}{\kern0pt}\isanewline
\isacommand{next}\isamarkupfalse%
\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ d\ x\isanewline
\ \ \isacommand{assume}\isamarkupfalse%
\ h{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}x\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step\ d{\isachardoublequoteclose}\ {\isachardoublequoteopen}{\isasymnot}\ {\isacharparenleft}{\kern0pt}d\ {\isacharequal}{\kern0pt}\ x\ {\isasymor}\ {\isasymnot}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d\ {\isasymLongrightarrow}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}mon\ \ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{hence}\isamarkupfalse%
\ {\isachardoublequoteopen}is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ d\ {\isasymLongrightarrow}\ d\ {\isasymnoteq}\ policy{\isacharunderscore}{\kern0pt}step\ d\ {\isasymLongrightarrow}\isanewline
\ \ \ \ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ d{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}step\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ eval{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}policy{\isacharunderscore}{\kern0pt}eq\ policy{\isacharunderscore}{\kern0pt}eval{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}force\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ order{\isachardot}{\kern0pt}not{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}order{\isacharunderscore}{\kern0pt}implies{\isacharunderscore}{\kern0pt}strict{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}x{\isacharcomma}{\kern0pt}\ d{\isacharparenright}{\kern0pt}\ {\isasymin}\ {\isacharbraceleft}{\kern0pt}{\isacharparenleft}{\kern0pt}u{\isacharcomma}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isachardot}{\kern0pt}\ u\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ v\ {\isasymin}\ D\isactrlsub D\ {\isasymand}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ v{\isacharparenright}{\kern0pt}\ {\isacharless}{\kern0pt}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ u{\isacharparenright}{\kern0pt}{\isacharbraceright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def\ h\ \isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
%
\endisadelimproof
%
\begin{isamarkuptext}%
The termination proof gives us access to the induction rule/simplification lemmas associated 
with the \isa{policy{\isacharunderscore}{\kern0pt}iteration} definition.
Thus we can prove that the algorithm finds an optimal policy.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{lemma}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi{\isacharprime}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D\ {\isasymLongrightarrow}\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}iteration\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ d\ rule{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}iteration{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ Let{\isacharunderscore}{\kern0pt}def\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ pi{\isacharunderscore}{\kern0pt}pi{\isacharbrackleft}{\kern0pt}simp{\isacharbrackright}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D\ {\isasymLongrightarrow}\ policy{\isacharunderscore}{\kern0pt}step\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}iteration\ d{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}iteration\ d{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ d\ rule{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}iteration{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}def\ Let{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ policy{\isacharunderscore}{\kern0pt}iteration{\isacharunderscore}{\kern0pt}correct{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}d\ {\isasymin}\ D\isactrlsub D\ {\isasymLongrightarrow}\ {\isasymnu}\isactrlsub b\ {\isacharparenleft}{\kern0pt}mk{\isacharunderscore}{\kern0pt}stationary{\isacharunderscore}{\kern0pt}det\ {\isacharparenleft}{\kern0pt}policy{\isacharunderscore}{\kern0pt}iteration\ d{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharequal}{\kern0pt}\ {\isasymnu}\isactrlsub b{\isacharunderscore}{\kern0pt}opt{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}induction\ d\ rule{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}iteration{\isachardot}{\kern0pt}induct{\isacharparenright}{\kern0pt}\isanewline
\ \ \ \ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}imp{\isacharunderscore}{\kern0pt}opt\ is{\isacharunderscore}{\kern0pt}dec{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}pi{\isacharprime}{\kern0pt}\ simp\ del{\isacharcolon}{\kern0pt}\ policy{\isacharunderscore}{\kern0pt}iteration{\isachardot}{\kern0pt}simps{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{context}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}type\ \isakeyword{begin}%
\begin{isamarkuptext}%
The following proofs concern code generation, i.e. how to represent \isa{{\isasymP}\isactrlsub {\isadigit{1}}} as a matrix.%
\end{isamarkuptext}\isamarkuptrue%
\isacommand{sublocale}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}att{\isacharunderscore}{\kern0pt}{\isasymL}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ A{\isacharunderscore}{\kern0pt}ne\ finite{\isacharunderscore}{\kern0pt}is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ MDP{\isacharunderscore}{\kern0pt}att{\isacharunderscore}{\kern0pt}{\isasymL}{\isacharunderscore}{\kern0pt}def\ MDP{\isacharunderscore}{\kern0pt}att{\isacharunderscore}{\kern0pt}{\isasymL}{\isacharunderscore}{\kern0pt}axioms{\isacharunderscore}{\kern0pt}def\ max{\isacharunderscore}{\kern0pt}L{\isacharunderscore}{\kern0pt}ex{\isacharunderscore}{\kern0pt}def\ \isanewline
\ \ \ \ \ \ has{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max{\isacharunderscore}{\kern0pt}def\ MDP{\isacharunderscore}{\kern0pt}reward{\isacharunderscore}{\kern0pt}axioms{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\ \isanewline
%
\endisadelimproof
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix\ f\ {\isacharequal}{\kern0pt}\ matrix\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymchi}\ j{\isachardot}{\kern0pt}\ f\ {\isacharparenleft}{\kern0pt}vec{\isacharunderscore}{\kern0pt}nth\ v{\isacharparenright}{\kern0pt}\ j{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}Ek{\isacharunderscore}{\kern0pt}mat\ d\ {\isacharequal}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Bfun\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat\ d\ {\isacharequal}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharunderscore}{\kern0pt}blinfun\ {\isacharminus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Bfun\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}nu{\isacharunderscore}{\kern0pt}mat\ d\ {\isacharequal}{\kern0pt}\ fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isasymSum}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Bfun\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ apply{\isacharunderscore}{\kern0pt}nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat{\isacharcolon}{\kern0pt}\ \isanewline
\ \ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}id{\isacharunderscore}{\kern0pt}blinfun\ {\isacharminus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ v\ {\isacharequal}{\kern0pt}\ Bfun\ {\isacharparenleft}{\kern0pt}{\isasymlambda}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat\ d{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}v\ {\isacharparenleft}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isachardollar}{\kern0pt}\ i{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharminus}{\kern0pt}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ eq{\isacharunderscore}{\kern0pt}onpI{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}P\ x\ {\isasymLongrightarrow}\ eq{\isacharunderscore}{\kern0pt}onp\ P\ x\ x{\isachardoublequoteclose}\ \isakeyword{for}\ P\ x\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
{\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ eq{\isacharunderscore}{\kern0pt}onp{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}\isanewline
\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}Real{\isacharunderscore}{\kern0pt}Vector{\isacharunderscore}{\kern0pt}Spaces{\isachardot}{\kern0pt}linear\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ vec{\isacharunderscore}{\kern0pt}lambda\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}id{\isacharunderscore}{\kern0pt}blinfun\ {\isacharminus}{\kern0pt}\ l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}bfun{\isachardot}{\kern0pt}Bfun\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isachardollar}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ del{\isacharcolon}{\kern0pt}\ real{\isacharunderscore}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}def\ intro{\isacharcolon}{\kern0pt}\ linearI\isanewline
\ \ \ \ \ \ \ \ simp{\isacharcolon}{\kern0pt}\ scaleR{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}def\ eq{\isacharunderscore}{\kern0pt}onpI\ plus{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}def\ vec{\isacharunderscore}{\kern0pt}lambda{\isacharunderscore}{\kern0pt}inverse\ plus{\isacharunderscore}{\kern0pt}bfun{\isachardot}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ \ \ scaleR{\isacharunderscore}{\kern0pt}bfun{\isachardot}{\kern0pt}abs{\isacharunderscore}{\kern0pt}eq{\isacharbrackleft}{\kern0pt}symmetric{\isacharbrackright}{\kern0pt}\ blinfun{\isachardot}{\kern0pt}scaleR{\isacharunderscore}{\kern0pt}right\ blinfun{\isachardot}{\kern0pt}add{\isacharunderscore}{\kern0pt}right{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{thus}\isamarkupfalse%
\ {\isacharquery}{\kern0pt}thesis\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ Ek{\isacharunderscore}{\kern0pt}mat{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix{\isacharunderscore}{\kern0pt}def\ nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ apply{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}inverse\ vec{\isacharunderscore}{\kern0pt}lambda{\isacharunderscore}{\kern0pt}inverse{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}bounded{\isacharunderscore}{\kern0pt}linear\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ vec{\isacharunderscore}{\kern0pt}lambda\ {\isacharparenleft}{\kern0pt}x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
%
\endisadelimproof
%
\isatagproof
\isacommand{proof}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}intro\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}intro{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{fix}\isamarkupfalse%
\ x\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isachardoublequoteclose}\isanewline
\ \ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}sqrt\ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ UNIV\ {\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ x\ i{\isacharparenright}{\kern0pt}\isactrlsup {\isadigit{2}}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ UNIV\ {\isachardot}{\kern0pt}\ {\isasymbar}{\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ x\ i{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{using}\isamarkupfalse%
\ L{\isadigit{2}}{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}le{\isacharunderscore}{\kern0pt}sum{\isacharunderscore}{\kern0pt}abs\ \isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ L{\isadigit{2}}{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ auto\isanewline
\ \ \isacommand{also}\isamarkupfalse%
\ \isacommand{have}\isamarkupfalse%
\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isasymSum}\ i\ {\isasymin}\ UNIV\ {\isachardot}{\kern0pt}\ {\isasymbar}{\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ x\ i{\isacharparenright}{\kern0pt}{\isasymbar}{\isacharparenright}{\kern0pt}\ {\isasymle}\ {\isacharparenleft}{\kern0pt}card\ {\isacharparenleft}{\kern0pt}UNIV\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharprime}{\kern0pt}s\ set{\isacharparenright}{\kern0pt}\ {\isacharasterisk}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}xa{\isachardot}{\kern0pt}\ {\isasymbar}apply{\isacharunderscore}{\kern0pt}bfun\ x\ xa{\isasymbar}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ cSup{\isacharunderscore}{\kern0pt}upper\ sum{\isacharunderscore}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}above{\isacharparenright}{\kern0pt}\isanewline
\ \ \isacommand{finally}\isamarkupfalse%
\ \isacommand{show}\isamarkupfalse%
\ {\isachardoublequoteopen}norm\ {\isacharparenleft}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda\ {\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ x{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isasymle}\ norm\ x\ {\isacharasterisk}{\kern0pt}\ CARD{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \ \ \isacommand{unfolding}\isamarkupfalse%
\ norm{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}def\ norm{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}def\ dist{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}def\ L{\isadigit{2}}{\isacharunderscore}{\kern0pt}set{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp\ add{\isacharcolon}{\kern0pt}\ mult{\isachardot}{\kern0pt}commute{\isacharparenright}{\kern0pt}\isanewline
\isacommand{qed}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ plus{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}def\ scaleR{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}def{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda{\isacharunderscore}{\kern0pt}blinfun{\isacharcolon}{\kern0pt}\ \isanewline
\ \ \isakeyword{fixes}\ f\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}\ {\isasymRightarrow}\isactrlsub L\ {\isacharparenleft}{\kern0pt}{\isacharprime}{\kern0pt}s\ {\isasymRightarrow}\isactrlsub b\ real{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\ \ \isakeyword{shows}\ {\isachardoublequoteopen}bounded{\isacharunderscore}{\kern0pt}linear\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ vec{\isacharunderscore}{\kern0pt}lambda\ {\isacharparenleft}{\kern0pt}apply{\isacharunderscore}{\kern0pt}bfun\ {\isacharparenleft}{\kern0pt}blinfun{\isacharunderscore}{\kern0pt}apply\ f\ {\isacharparenleft}{\kern0pt}bfun{\isachardot}{\kern0pt}Bfun\ {\isacharparenleft}{\kern0pt}{\isacharparenleft}{\kern0pt}{\isachardollar}{\kern0pt}{\isacharparenright}{\kern0pt}\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\ \isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{using}\isamarkupfalse%
\ blinfun{\isachardot}{\kern0pt}bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}right\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}fastforce\ intro{\isacharcolon}{\kern0pt}\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}compose{\isacharbrackleft}{\kern0pt}OF\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda{\isacharbrackright}{\kern0pt}\ \isanewline
\ \ \ \ \ \ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}nth\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}compose{\isacharbrackleft}{\kern0pt}of\ f{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ invertible{\isacharunderscore}{\kern0pt}nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}max{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}invertible\ {\isacharparenleft}{\kern0pt}nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat\ d{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{unfolding}\isamarkupfalse%
\ nu{\isacharunderscore}{\kern0pt}inv{\isacharunderscore}{\kern0pt}mat{\isacharunderscore}{\kern0pt}def\ fun{\isacharunderscore}{\kern0pt}to{\isacharunderscore}{\kern0pt}matrix{\isacharunderscore}{\kern0pt}def\isanewline
\ \ \isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}auto\ simp{\isacharcolon}{\kern0pt}\ matrix{\isacharunderscore}{\kern0pt}invertible\ inv{\isacharunderscore}{\kern0pt}norm{\isacharunderscore}{\kern0pt}le{\isacharprime}{\kern0pt}\ vec{\isacharunderscore}{\kern0pt}lambda{\isacharunderscore}{\kern0pt}inverse\ apply{\isacharunderscore}{\kern0pt}bfun{\isacharunderscore}{\kern0pt}inverse\ \isanewline
\ \ \ \ \ \ bounded{\isacharunderscore}{\kern0pt}linear{\isachardot}{\kern0pt}linear{\isacharbrackleft}{\kern0pt}OF\ bounded{\isacharunderscore}{\kern0pt}linear{\isacharunderscore}{\kern0pt}vec{\isacharunderscore}{\kern0pt}lambda{\isacharunderscore}{\kern0pt}blinfun{\isacharbrackright}{\kern0pt}\isanewline
\ \ \ \ \ \ intro{\isacharbang}{\kern0pt}{\isacharcolon}{\kern0pt}\ exI{\isacharbrackleft}{\kern0pt}of\ {\isacharunderscore}{\kern0pt}\ {\isachardoublequoteopen}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymchi}\ j{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymlambda}v{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSum}i{\isachardot}{\kern0pt}\ {\isacharparenleft}{\kern0pt}l\ {\isacharasterisk}{\kern0pt}\isactrlsub R\ {\isasymP}\isactrlsub {\isadigit{1}}\ d{\isacharparenright}{\kern0pt}\ {\isacharcircum}{\kern0pt}{\isacharcircum}{\kern0pt}\ i{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}Bfun\ v{\isacharparenright}{\kern0pt}{\isacharparenright}{\kern0pt}\ {\isacharparenleft}{\kern0pt}vec{\isacharunderscore}{\kern0pt}nth\ v{\isacharparenright}{\kern0pt}\ j{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}{\isacharbrackright}{\kern0pt}{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
\isanewline
\isacommand{definition}\isamarkupfalse%
\ {\isachardoublequoteopen}least{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ f\ P\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}LEAST\ x{\isachardot}{\kern0pt}\ is{\isacharunderscore}{\kern0pt}arg{\isacharunderscore}{\kern0pt}max\ f\ P\ x{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{locale}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}ord\ {\isacharequal}{\kern0pt}\ MDP{\isacharunderscore}{\kern0pt}finite{\isacharunderscore}{\kern0pt}type\ A\ K\ r\ l\isanewline
\ \ \isakeyword{for}\ A\ \isakeyword{and}\isanewline
\ \ \ \ K\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isacharprime}{\kern0pt}s\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}finite{\isacharcomma}{\kern0pt}\ wellorder{\isacharbraceright}{\kern0pt}\ {\isasymtimes}\ {\isacharprime}{\kern0pt}a\ {\isacharcolon}{\kern0pt}{\isacharcolon}{\kern0pt}\ {\isacharbraceleft}{\kern0pt}finite{\isacharcomma}{\kern0pt}\ wellorder{\isacharbraceright}{\kern0pt}\ {\isasymRightarrow}\ {\isacharprime}{\kern0pt}s\ pmf{\isachardoublequoteclose}\isanewline
\ \ \ \ \isakeyword{and}\ r\ l\isanewline
\isakeyword{begin}\isanewline
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isasymL}{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}det{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymL}\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}a\ {\isasymin}\ A\ s{\isachardot}{\kern0pt}\ L\isactrlsub a\ a\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}eq\ {\isasymL}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}det{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{lemma}\isamarkupfalse%
\ {\isasymL}\isactrlsub b{\isacharunderscore}{\kern0pt}fin{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}det{\isacharcolon}{\kern0pt}\ {\isachardoublequoteopen}{\isasymL}\isactrlsub b\ v\ s\ {\isacharequal}{\kern0pt}\ {\isacharparenleft}{\kern0pt}{\isasymSqunion}a\ {\isasymin}\ A\ s{\isachardot}{\kern0pt}\ L\isactrlsub a\ a\ v\ s{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ {\isacharparenleft}{\kern0pt}simp\ add{\isacharcolon}{\kern0pt}\ SUP{\isacharunderscore}{\kern0pt}step{\isacharunderscore}{\kern0pt}det{\isacharunderscore}{\kern0pt}eq\ {\isasymL}\isactrlsub b{\isachardot}{\kern0pt}rep{\isacharunderscore}{\kern0pt}eq\ {\isasymL}{\isacharunderscore}{\kern0pt}eq{\isacharunderscore}{\kern0pt}SUP{\isacharunderscore}{\kern0pt}det{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{sublocale}\isamarkupfalse%
\ MDP{\isacharunderscore}{\kern0pt}PI{\isacharunderscore}{\kern0pt}finite\ A\ K\ r\ l\ {\isachardoublequoteopen}{\isasymlambda}X{\isachardot}{\kern0pt}\ Least\ {\isacharparenleft}{\kern0pt}{\isasymlambda}x{\isachardot}{\kern0pt}\ x\ {\isasymin}\ X{\isacharparenright}{\kern0pt}{\isachardoublequoteclose}\isanewline
%
\isadelimproof
\ \ %
\endisadelimproof
%
\isatagproof
\isacommand{by}\isamarkupfalse%
\ unfold{\isacharunderscore}{\kern0pt}locales\ {\isacharparenleft}{\kern0pt}auto\ intro{\isacharcolon}{\kern0pt}\ LeastI{\isacharparenright}{\kern0pt}%
\endisatagproof
{\isafoldproof}%
%
\isadelimproof
\isanewline
%
\endisadelimproof
\isanewline
\isacommand{end}\isamarkupfalse%
\isanewline
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
\endinput
%:%file=Policy_Iteration.tex%:%
%:%6=1%:%
%:%7=2%:%
%:%12=3%:%
%:%13=3%:%
%:%14=4%:%
%:%15=5%:%
%:%16=6%:%
%:%30=8%:%
%:%42=10%:%
%:%43=11%:%
%:%44=12%:%
%:%45=13%:%
%:%46=14%:%
%:%47=15%:%
%:%48=16%:%
%:%49=17%:%
%:%50=18%:%
%:%51=19%:%
%:%53=23%:%
%:%54=23%:%
%:%55=24%:%
%:%56=24%:%
%:%57=25%:%
%:%58=25%:%
%:%59=26%:%
%:%60=27%:%
%:%61=27%:%
%:%62=28%:%
%:%63=29%:%
%:%64=30%:%
%:%65=30%:%
%:%68=33%:%
%:%69=34%:%
%:%70=35%:%
%:%71=35%:%
%:%72=36%:%
%:%73=37%:%
%:%74=38%:%
%:%75=38%:%
%:%76=39%:%
%:%78=41%:%
%:%81=42%:%
%:%85=42%:%
%:%86=42%:%
%:%95=45%:%
%:%96=46%:%
%:%100=50%:%
%:%102=52%:%
%:%103=52%:%
%:%106=53%:%
%:%110=53%:%
%:%111=53%:%
%:%112=54%:%
%:%113=54%:%
%:%118=54%:%
%:%121=55%:%
%:%122=56%:%
%:%123=56%:%
%:%126=57%:%
%:%130=57%:%
%:%131=57%:%
%:%132=58%:%
%:%133=58%:%
%:%134=59%:%
%:%135=59%:%
%:%140=59%:%
%:%143=60%:%
%:%144=61%:%
%:%145=61%:%
%:%146=62%:%
%:%147=63%:%
%:%154=64%:%
%:%155=64%:%
%:%156=65%:%
%:%157=65%:%
%:%158=66%:%
%:%159=66%:%
%:%160=67%:%
%:%161=67%:%
%:%162=68%:%
%:%163=69%:%
%:%164=69%:%
%:%165=70%:%
%:%166=70%:%
%:%167=71%:%
%:%168=71%:%
%:%169=72%:%
%:%175=72%:%
%:%178=73%:%
%:%179=74%:%
%:%180=74%:%
%:%181=75%:%
%:%182=76%:%
%:%185=77%:%
%:%189=77%:%
%:%190=77%:%
%:%191=78%:%
%:%192=78%:%
%:%193=79%:%
%:%194=79%:%
%:%203=81%:%
%:%204=82%:%
%:%206=83%:%
%:%207=83%:%
%:%208=84%:%
%:%209=85%:%
%:%216=86%:%
%:%217=86%:%
%:%218=87%:%
%:%219=87%:%
%:%220=88%:%
%:%221=88%:%
%:%222=89%:%
%:%223=89%:%
%:%224=90%:%
%:%225=91%:%
%:%226=91%:%
%:%227=92%:%
%:%228=92%:%
%:%229=93%:%
%:%230=93%:%
%:%231=94%:%
%:%232=94%:%
%:%233=95%:%
%:%234=95%:%
%:%235=96%:%
%:%236=96%:%
%:%237=97%:%
%:%238=97%:%
%:%239=98%:%
%:%240=98%:%
%:%241=99%:%
%:%242=99%:%
%:%243=100%:%
%:%244=100%:%
%:%245=101%:%
%:%246=101%:%
%:%247=102%:%
%:%248=102%:%
%:%249=103%:%
%:%250=103%:%
%:%251=104%:%
%:%252=104%:%
%:%253=105%:%
%:%254=105%:%
%:%255=106%:%
%:%256=106%:%
%:%257=107%:%
%:%258=107%:%
%:%259=108%:%
%:%260=108%:%
%:%261=109%:%
%:%262=109%:%
%:%263=110%:%
%:%264=110%:%
%:%265=111%:%
%:%275=114%:%
%:%277=116%:%
%:%278=116%:%
%:%279=117%:%
%:%280=118%:%
%:%287=119%:%
%:%288=119%:%
%:%289=120%:%
%:%290=120%:%
%:%291=121%:%
%:%292=121%:%
%:%293=122%:%
%:%294=122%:%
%:%295=123%:%
%:%296=123%:%
%:%297=124%:%
%:%298=124%:%
%:%299=125%:%
%:%300=125%:%
%:%301=126%:%
%:%302=126%:%
%:%303=127%:%
%:%304=127%:%
%:%305=128%:%
%:%311=128%:%
%:%314=129%:%
%:%315=130%:%
%:%318=132%:%
%:%320=133%:%
%:%321=133%:%
%:%322=134%:%
%:%323=135%:%
%:%324=136%:%
%:%325=137%:%
%:%326=138%:%
%:%328=140%:%
%:%329=141%:%
%:%331=142%:%
%:%332=142%:%
%:%339=143%:%
%:%340=143%:%
%:%341=144%:%
%:%342=144%:%
%:%343=145%:%
%:%344=145%:%
%:%345=146%:%
%:%346=146%:%
%:%347=146%:%
%:%348=147%:%
%:%349=147%:%
%:%350=148%:%
%:%351=148%:%
%:%352=149%:%
%:%353=149%:%
%:%354=150%:%
%:%355=150%:%
%:%356=150%:%
%:%357=151%:%
%:%358=151%:%
%:%359=152%:%
%:%360=152%:%
%:%361=153%:%
%:%362=153%:%
%:%363=153%:%
%:%364=154%:%
%:%365=154%:%
%:%366=155%:%
%:%367=155%:%
%:%368=156%:%
%:%374=156%:%
%:%377=157%:%
%:%378=158%:%
%:%379=158%:%
%:%380=159%:%
%:%387=160%:%
%:%388=160%:%
%:%389=161%:%
%:%390=161%:%
%:%391=162%:%
%:%392=162%:%
%:%393=163%:%
%:%394=163%:%
%:%395=164%:%
%:%396=164%:%
%:%397=165%:%
%:%407=168%:%
%:%408=169%:%
%:%410=171%:%
%:%411=171%:%
%:%412=172%:%
%:%413=173%:%
%:%420=174%:%
%:%421=174%:%
%:%422=175%:%
%:%423=175%:%
%:%424=176%:%
%:%425=176%:%
%:%426=177%:%
%:%427=177%:%
%:%428=178%:%
%:%429=178%:%
%:%430=179%:%
%:%431=179%:%
%:%432=180%:%
%:%433=180%:%
%:%434=181%:%
%:%435=181%:%
%:%436=182%:%
%:%437=182%:%
%:%438=183%:%
%:%439=183%:%
%:%440=184%:%
%:%441=184%:%
%:%442=185%:%
%:%443=185%:%
%:%444=185%:%
%:%445=186%:%
%:%446=186%:%
%:%447=187%:%
%:%448=187%:%
%:%449=188%:%
%:%450=188%:%
%:%451=189%:%
%:%452=189%:%
%:%453=190%:%
%:%454=190%:%
%:%455=191%:%
%:%456=192%:%
%:%457=192%:%
%:%458=193%:%
%:%459=193%:%
%:%460=194%:%
%:%461=194%:%
%:%462=195%:%
%:%472=198%:%
%:%473=199%:%
%:%474=200%:%
%:%476=202%:%
%:%477=202%:%
%:%484=203%:%
%:%485=203%:%
%:%486=204%:%
%:%487=204%:%
%:%488=205%:%
%:%489=205%:%
%:%490=206%:%
%:%491=206%:%
%:%492=207%:%
%:%493=207%:%
%:%494=208%:%
%:%495=208%:%
%:%496=209%:%
%:%497=209%:%
%:%498=210%:%
%:%499=210%:%
%:%500=211%:%
%:%501=211%:%
%:%502=212%:%
%:%503=212%:%
%:%504=213%:%
%:%505=213%:%
%:%506=214%:%
%:%507=215%:%
%:%508=215%:%
%:%509=216%:%
%:%510=216%:%
%:%511=217%:%
%:%512=217%:%
%:%513=218%:%
%:%514=218%:%
%:%515=219%:%
%:%516=219%:%
%:%517=220%:%
%:%527=223%:%
%:%528=224%:%
%:%529=225%:%
%:%531=228%:%
%:%532=228%:%
%:%535=229%:%
%:%539=229%:%
%:%540=229%:%
%:%541=230%:%
%:%542=230%:%
%:%547=230%:%
%:%550=231%:%
%:%551=232%:%
%:%552=232%:%
%:%555=233%:%
%:%559=233%:%
%:%560=233%:%
%:%561=234%:%
%:%562=234%:%
%:%567=234%:%
%:%570=235%:%
%:%571=236%:%
%:%572=236%:%
%:%573=237%:%
%:%576=238%:%
%:%580=238%:%
%:%581=238%:%
%:%582=239%:%
%:%587=239%:%
%:%590=240%:%
%:%591=240%:%
%:%592=241%:%
%:%593=242%:%
%:%594=242%:%
%:%596=244%:%
%:%598=247%:%
%:%599=247%:%
%:%602=248%:%
%:%606=248%:%
%:%607=248%:%
%:%608=249%:%
%:%613=249%:%
%:%616=250%:%
%:%617=251%:%
%:%618=251%:%
%:%619=252%:%
%:%620=252%:%
%:%621=253%:%
%:%622=253%:%
%:%623=254%:%
%:%624=254%:%
%:%625=255%:%
%:%626=256%:%
%:%627=256%:%
%:%628=257%:%
%:%635=258%:%
%:%636=258%:%
%:%637=259%:%
%:%638=259%:%
%:%639=260%:%
%:%640=260%:%
%:%641=261%:%
%:%642=262%:%
%:%643=262%:%
%:%644=263%:%
%:%645=263%:%
%:%646=264%:%
%:%647=265%:%
%:%648=266%:%
%:%649=266%:%
%:%650=267%:%
%:%651=267%:%
%:%652=268%:%
%:%653=268%:%
%:%654=269%:%
%:%660=269%:%
%:%663=270%:%
%:%664=271%:%
%:%665=271%:%
%:%672=272%:%
%:%673=272%:%
%:%674=273%:%
%:%675=273%:%
%:%676=274%:%
%:%677=274%:%
%:%678=275%:%
%:%679=275%:%
%:%680=276%:%
%:%681=276%:%
%:%682=277%:%
%:%683=277%:%
%:%684=278%:%
%:%685=278%:%
%:%686=278%:%
%:%687=279%:%
%:%688=279%:%
%:%689=280%:%
%:%690=280%:%
%:%691=280%:%
%:%692=281%:%
%:%693=281%:%
%:%694=282%:%
%:%695=282%:%
%:%696=283%:%
%:%697=283%:%
%:%702=283%:%
%:%705=284%:%
%:%706=285%:%
%:%707=286%:%
%:%708=286%:%
%:%709=287%:%
%:%710=288%:%
%:%713=289%:%
%:%717=289%:%
%:%718=289%:%
%:%719=290%:%
%:%720=290%:%
%:%721=291%:%
%:%726=291%:%
%:%729=292%:%
%:%730=293%:%
%:%731=293%:%
%:%734=294%:%
%:%738=294%:%
%:%739=294%:%
%:%740=295%:%
%:%741=295%:%
%:%742=296%:%
%:%743=297%:%
%:%748=297%:%
%:%751=298%:%
%:%752=299%:%
%:%753=299%:%
%:%754=300%:%
%:%755=301%:%
%:%756=301%:%
%:%757=302%:%
%:%758=303%:%
%:%759=303%:%
%:%760=304%:%
%:%761=305%:%
%:%762=306%:%
%:%763=307%:%
%:%764=308%:%
%:%765=309%:%
%:%766=309%:%
%:%769=310%:%
%:%773=310%:%
%:%774=310%:%
%:%779=310%:%
%:%782=311%:%
%:%783=312%:%
%:%784=312%:%
%:%787=313%:%
%:%791=313%:%
%:%792=313%:%
%:%797=313%:%
%:%800=314%:%
%:%801=315%:%
%:%802=315%:%
%:%805=316%:%
%:%809=316%:%
%:%810=316%:%
%:%815=316%:%
%:%818=317%:%
%:%819=318%:%
%:%820=318%:%
%:%827=319%:%
